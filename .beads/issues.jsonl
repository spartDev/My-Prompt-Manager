{"id":"My-Prompt-Manager-02t","title":"Add concurrent operation tests for clearHistory()","description":"## Context\nPR #251 added withLock() to clearHistory() to fix a race condition, but there are no tests verifying the fix.\n\n## Missing Tests\n- Concurrent clearHistory() + record() operations\n- Concurrent clearHistory() + cleanup() operations\n- Concurrent clearHistory() + clearHistory() operations\n\n## Files\n- `src/services/UsageTracker.ts` (lines 167-175)\n- `src/services/__tests__/UsageTracker.test.ts`\n\n## Acceptance Criteria\n- [ ] Test concurrent clearHistory() and record() don't corrupt data\n- [ ] Test concurrent clearHistory() and cleanup() don't corrupt data\n- [ ] Verify operations are properly serialized by mutex","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-20T16:49:51.767835+01:00","created_by":"spartDev","updated_at":"2026-01-20T16:56:40.451569+01:00","closed_at":"2026-01-20T16:56:40.451569+01:00","close_reason":"Tests added and verified passing"}
{"id":"My-Prompt-Manager-02y","title":"Move runtime constants from types to constants file","description":"DEFAULT_SETTINGS, VALIDATION_LIMITS, PROMPT_SHARING_SIZE_LIMITS, USAGE_RETENTION_DAYS are runtime values exported from types/index.ts. Move to src/constants.ts for cleaner separation.","status":"closed","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-21T18:48:49.1066+01:00","created_by":"spartDev","updated_at":"2026-01-23T10:13:49.73468+01:00","closed_at":"2026-01-23T10:13:49.73468+01:00","close_reason":"Runtime constants moved to src/constants/index.ts with re-exports from types for backward compatibility"}
{"id":"My-Prompt-Manager-0g6","title":"Add focus trap to ConfigurationPreview modal","description":"**Location:** ConfigurationPreview.tsx\n\n**Problem:** Modal doesn't trap focus, which is an accessibility issue. Users can tab out of the modal to elements behind it.\n\n**Fix:** Options:\n1. Use @radix-ui/react-dialog for built-in focus management\n2. Use react-focus-lock library\n3. Implement manual focus trap:\n```typescript\nimport { useRef, useEffect } from 'react';\n\nfunction useFocusTrap(isOpen: boolean) {\n  const containerRef = useRef\u003cHTMLDivElement\u003e(null);\n  \n  useEffect(() =\u003e {\n    if (\\!isOpen || \\!containerRef.current) return;\n    \n    const focusableElements = containerRef.current.querySelectorAll(\n      'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n    );\n    const firstElement = focusableElements[0] as HTMLElement;\n    const lastElement = focusableElements[focusableElements.length - 1] as HTMLElement;\n    \n    // ... trap implementation\n  }, [isOpen]);\n  \n  return containerRef;\n}\n```\n\n**Impact:** MEDIUM - Accessibility violation (WCAG 2.4.3)","status":"open","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:24:59.518194+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:24:59.518194+01:00"}
{"id":"My-Prompt-Manager-0je","title":"Memoize getSortLabel in FilterSortControls","description":"FilterSortControls.tsx defines getSortLabel function (lines 33-50) that is called on every render without memoization.\n\n**Location:** src/components/FilterSortControls.tsx:33-50\n\n**Current:**\n```typescript\nconst getSortLabel = (): string =\u003e {\n  const option = SORT_OPTIONS.find(opt =\u003e opt.value === sortOrder);\n  // ...\n};\n\nconst sortLabel = getSortLabel();\n```\n\n**Fix:** Use useMemo directly:\n```typescript\nconst sortLabel = useMemo(() =\u003e {\n  const option = SORT_OPTIONS.find(opt =\u003e opt.value === sortOrder);\n  if (!option) return 'A→Z';\n  // ...\n}, [sortOrder, sortDirection]);\n```\n\n## Acceptance Criteria\n\n- [ ] `getSortLabel` function is removed and replaced with a `useMemo` call\n- [ ] `sortLabel` is computed via `useMemo` with dependencies `[sortOrder, sortDirection]`\n- [ ] Return type is explicitly `string`\n- [ ] Sort label displays correctly for all sort options (manual verification)\n- [ ] All existing FilterSortControls tests pass (`npm test src/components/FilterSortControls`)\n- [ ] No TypeScript errors (`npm run typecheck`)\n- [ ] Linting passes (`npm run lint`)","status":"closed","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-23T21:45:33.146033+01:00","created_by":"spartDev","updated_at":"2026-01-24T07:15:00.203212+01:00","closed_at":"2026-01-24T07:15:00.203212+01:00","close_reason":"Implemented - getSortLabel replaced with useMemo"}
{"id":"My-Prompt-Manager-0mi","title":"E2E test: verify MAX_PROMPT_SIZE fix and updatePrompt validation","description":"Create E2E test to ensure the bug fixed in commit 1e499f0 doesn't regress.\n\n**Bug summary:**\n1. MAX_PROMPT_SIZE was 10KB but should be 50KB to support 20K character prompts (20K chars × 2 bytes/char + overhead)\n2. updatePrompt() was missing size validation that savePrompt() had, causing inconsistent behavior\n\n**Test scenarios needed:**\n- Add a prompt near the 20K character limit (~19K chars) - should succeed\n- Update an existing prompt to near 20K characters - should succeed  \n- Both add and update should fail consistently when exceeding limits\n- Verify error messages match between add and update operations","status":"closed","priority":1,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-12T17:04:11.022432+01:00","created_by":"spartDev","updated_at":"2026-01-12T17:34:50.1893+01:00","closed_at":"2026-01-12T17:34:50.1893+01:00","close_reason":"Created E2E test file tests/e2e/storage/prompt-size-limits.spec.ts with 5 passing tests that verify the MAX_PROMPT_SIZE fix from commit 1e499f0"}
{"id":"My-Prompt-Manager-0n5","title":"Refactor Analytics header to use ViewHeader component","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-13T13:51:24.364166+01:00","created_by":"spartDev","updated_at":"2026-01-13T14:03:12.791313+01:00","closed_at":"2026-01-13T14:03:12.791313+01:00","close_reason":"Closed","comments":[{"id":1,"issue_id":"My-Prompt-Manager-0n5","author":"spartDev","text":"Replace inline header in AnalyticsTab.tsx (lines 179-219) with the shared ViewHeader component to match LibraryView and SettingsView patterns. Import ViewHeader and use icon='analytics', title='Analytics', subtitle='Last 30 days of usage'.","created_at":"2026-01-13T12:52:30Z"}]}
{"id":"My-Prompt-Manager-0yy","title":"Fix inline onToggle in NotificationTypeRow rendering","description":"**Location:** NotificationSection.tsx:256-264\n\n**Problem:** Creates new function for each notification type:\n```typescript\n{NOTIFICATION_TYPES.map(({ type, label, description, color }) =\u003e (\n  \u003cNotificationTypeRow\n    key={type}\n    onToggle={(checked) =\u003e {\n      onSettingsChange({\n        enabledTypes: {\n          ...currentEnabledTypes,\n          [type]: checked\n        }\n      });\n    }}\n  /\u003e\n))}\n```\n\n**Fix:** Use useCallback with type parameter:\n```typescript\nconst handleTypeToggle = useCallback((type: ToastType, checked: boolean) =\u003e {\n  onSettingsChange({\n    enabledTypes: {\n      ...currentEnabledTypes,\n      [type]: checked\n    }\n  });\n}, [onSettingsChange, currentEnabledTypes]);\n\n// In render - pass type to child\n\u003cNotificationTypeRow\n  onToggle={(checked) =\u003e handleTypeToggle(type, checked)}\n/\u003e\n```\n\nOr modify NotificationTypeRow to accept type and single handler.\n\n**Impact:** MEDIUM - 4 new functions created on every render","status":"open","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:25:03.960504+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:25:03.960504+01:00"}
{"id":"My-Prompt-Manager-11v","title":"Add test coverage for UsageTracker quota protection","description":"## Context\nPR #251 introduced quota protection to UsageTracker but lacks test coverage.\n\n## Missing Tests\n- `trimOldEvents()` private method behavior\n- Proactive cleanup triggering at CLEANUP_THRESHOLD (9,000 events)\n- Hard limit enforcement at MAX_EVENTS (10,000 events)\n- Logging verification for both cleanup scenarios\n\n## Files\n- `src/services/UsageTracker.ts` (lines 68-91, 106-109)\n- `src/services/__tests__/UsageTracker.test.ts`\n\n## Acceptance Criteria\n- [ ] Test proactive cleanup triggers at 9,000 events\n- [ ] Test hard limit removes oldest events at 10,000\n- [ ] Test trimOldEvents filters by retention period\n- [ ] Verify appropriate logging calls","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-20T16:49:50.755321+01:00","created_by":"spartDev","updated_at":"2026-01-20T16:56:40.429919+01:00","closed_at":"2026-01-20T16:56:40.429919+01:00","close_reason":"Tests added and verified passing"}
{"id":"My-Prompt-Manager-1dn","title":"Add analyticsAssertions to assertions.ts","description":"Add analyticsAssertions object to tests/e2e/utils/assertions.ts. Include: tabLoaded, dashboardLoaded, emptyState, totalUses, topPlatform, peakDay, topCategory, promptInTopList, topPromptsCount, trophyIconsVisible, clearHistoryModalVisible/Hidden, expandButtonVisible/Hidden, tabSelected, chartVisible. Add to main assertions export.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-16T13:26:06.175519+01:00","created_by":"spartDev","updated_at":"2026-01-16T14:37:47.607951+01:00","closed_at":"2026-01-16T14:37:47.607951+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-1f5","title":"Add floating action button for View Full Dashboard","description":"Add a floating action button (FAB) with gradient styling positioned at bottom-right. Use purple-indigo gradient, shadow, and focus-primary class per design system","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-16T12:41:39.996658+01:00","created_by":"spartDev","updated_at":"2026-01-16T12:46:29.0113+01:00","closed_at":"2026-01-16T12:46:29.0113+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-1h4","title":"Fix missing saveSettings in useEffect dependencies","description":"**Location:** SettingsView.tsx:179-201\n\n**Problem:** saveSettings function is not in the dependency array but is used inside useEffect:\n```typescript\nuseEffect(() =\u003e {\n  // ...\n  saveSettings(settings).catch(...);\n  // ...\n}, [settings]);  // Missing saveSettings dependency!\n```\n\n**Fix:** Wrap saveSettings in useCallback:\n```typescript\nconst saveSettings = useCallback(async (newSettings: Settings) =\u003e {\n  setSaving(true);\n  // ... rest of implementation\n}, []);  // No deps needed if using refs or stable values\n```\n\n**Impact:** HIGH - Potential stale closure bugs","status":"open","priority":1,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:23:17.161003+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:23:17.161003+01:00"}
{"id":"My-Prompt-Manager-1lg","title":"Add ANALYTICS_FIXTURES to test-data.ts","description":"Add to tests/e2e/fixtures/test-data.ts: ANALYTICS_FIXTURES with EMPTY, SINGLE_USAGE, VARIED_USAGE, MULTI_PLATFORM scenarios. Add createAnalyticsScenario helper function that generates prompts, categories, and usageHistory.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-16T13:26:08.880112+01:00","created_by":"spartDev","updated_at":"2026-01-16T14:37:47.677486+01:00","closed_at":"2026-01-16T14:37:47.677486+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-1w6","title":"Type platform field as union literal instead of string","description":"UsageEvent.platform (index.ts:16-17) is typed as string but should be union literal: 'claude' | 'chatgpt' | 'gemini' | 'perplexity' | 'copilot' | 'mistral' | 'custom'. Create PlatformType type.","status":"closed","priority":1,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-21T18:48:39.355454+01:00","created_by":"spartDev","updated_at":"2026-01-21T18:54:57.141941+01:00","closed_at":"2026-01-21T18:54:57.141941+01:00","close_reason":"Created PlatformType union literal type and updated UsageEvent.platform, UsageTracker.record(), and related code"}
{"id":"My-Prompt-Manager-1y7","title":"Unify category selector pattern across forms","description":"## Location\n- src/components/AddPromptForm.tsx (uses Dropdown component)\n- src/components/EditPromptForm.tsx (uses native select element)\n\n## Problem\nInconsistent UI patterns for the same functionality. AddPromptForm uses custom Dropdown while EditPromptForm uses native select.\n\n## Impact\n- Inconsistent user experience between Add and Edit views\n- Different styling between the two\n- Maintenance burden (two patterns to update)\n\n## Recommendation\nUse the Dropdown component in EditPromptForm for consistency, or update AddPromptForm to use native select if simplicity is preferred.","status":"closed","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-23T10:29:42.421825+01:00","created_by":"spartDev","updated_at":"2026-01-23T15:42:40.60687+01:00","closed_at":"2026-01-23T15:42:40.60687+01:00","close_reason":"Fixed by PR (branch fix/unify-category-selector). Replaced native select with Dropdown component for consistent UI between Add and Edit forms."}
{"id":"My-Prompt-Manager-233","title":"Remove unused refs in EditPromptForm","description":"## Location\nsrc/components/EditPromptForm.tsx:17-19\n\n## Problem\nTwo refs are declared but never used:\n\n```tsx\n// Refs to form elements (for focus management if needed)\nconst titleRef = useRef\u003cHTMLInputElement\u003e(null);\nconst contentRef = useRef\u003cHTMLTextAreaElement\u003e(null);\n```\n\n## Fix\nEither:\n1. Remove the refs if focus management is not needed\n2. Implement focus management - e.g., focus title on mount, focus error field on validation failure\n\n## Impact\n- Dead code removal\n- Cleaner component","status":"closed","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-23T10:29:38.852115+01:00","created_by":"spartDev","updated_at":"2026-01-23T15:25:07.15462+01:00","closed_at":"2026-01-23T15:25:07.15462+01:00","close_reason":"Fixed by removing unused refs. PR #289 created."}
{"id":"My-Prompt-Manager-24o","title":"Hoist SVG icon and add dark mode to ErrorBoundary.tsx","description":"**Context**: ErrorBoundary.tsx has a warning icon SVG recreated every render and lacks dark mode support in the fallback UI.\n\n**Work Required**:\n- Extract warning icon SVG to module-scope constant\n- Add dark mode classes to fallback UI container and card\n\n**Acceptance Criteria**:\n- [ ] Warning icon SVG is defined at module scope\n- [ ] Fallback container has dark:bg-gray-900 class\n- [ ] Fallback card has dark:bg-gray-800 class\n- [ ] Text colors have appropriate dark mode variants\n- [ ] All 4 existing tests pass\n- [ ] npm run lint passes\n- [ ] npm run typecheck passes","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-24T22:39:30.704502+01:00","created_by":"spartDev","updated_at":"2026-01-24T23:00:04.074969+01:00","closed_at":"2026-01-24T23:00:04.074969+01:00","close_reason":"PR #308 created with SVG hoisting and dark mode support"}
{"id":"My-Prompt-Manager-2jr","title":"Add quota protection to UsageTracker","description":"UsageTracker.ts:59-63 - StorageManager has quota checks, UsageTracker writes blindly. 30 days of heavy usage = thousands of events = storage quota blown. Add a max event count or proactive cleanup.","status":"closed","priority":0,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-19T23:29:35.006476+01:00","created_by":"spartDev","updated_at":"2026-01-20T16:00:59.950463+01:00","closed_at":"2026-01-20T16:00:59.950463+01:00","close_reason":"Fixed: all tests pass"}
{"id":"My-Prompt-Manager-2kv","title":"Consider File System Access API for modern export","description":"**Location:** DataStorageSection.tsx:32-49\n\n**Problem:** Export uses legacy DOM manipulation pattern:\n```typescript\nconst handleExport = () =\u003e {\n  const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });\n  const url = URL.createObjectURL(blob);\n  const a = document.createElement('a');\n  a.href = url;\n  a.download = `prompt-library-backup-${new Date().toISOString().split('T')[0]}.json`;\n  document.body.appendChild(a);\n  a.click();\n  document.body.removeChild(a);\n  URL.revokeObjectURL(url);\n};\n```\n\n**Fix:** Use File System Access API with fallback:\n```typescript\nconst handleExport = async () =\u003e {\n  const data = {...};\n  const content = JSON.stringify(data, null, 2);\n  const filename = `prompt-library-backup-${new Date().toISOString().split('T')[0]}.json`;\n  \n  if ('showSaveFilePicker' in window) {\n    try {\n      const handle = await window.showSaveFilePicker({\n        suggestedName: filename,\n        types: [{ description: 'JSON', accept: { 'application/json': ['.json'] } }]\n      });\n      const writable = await handle.createWritable();\n      await writable.write(content);\n      await writable.close();\n      return;\n    } catch (e) {\n      if ((e as Error).name === 'AbortError') return;\n    }\n  }\n  \n  // Fallback to legacy method\n  // ...\n};\n```\n\n**Impact:** MEDIUM - Better UX on modern browsers","status":"open","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:25:17.699983+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:25:17.699983+01:00"}
{"id":"My-Prompt-Manager-2wf","title":"Move assertions out of Page Objects into assertions.ts","description":"## Problem\nPage Object Model best practices state that page objects should not contain assertions. Currently `BasePage.ts` has assertion methods that should live in test files or the assertions utility.\n\n## Current Issues in BasePage.ts\n- `expectSuccessMessage(message)` - performs visibility assertion\n- `expectErrorMessage(message)` - performs visibility assertion\n- `expectElementVisible(locator)` - performs visibility assertion\n- `expectElementHidden(locator)` - performs hidden assertion\n\n## Best Practice\nPage objects should only:\n1. Define locators for page elements\n2. Provide action methods (click, fill, navigate)\n3. Return locators for assertions in tests\n\n## Solution\nRefactor page objects to return locators instead of performing assertions:\n\n**Before:**\n```typescript\nasync expectSuccessMessage(message: string): Promise\u003cvoid\u003e {\n  await expect(this.page.getByText(message).first()).toBeVisible();\n}\n```\n\n**After:**\n```typescript\ngetSuccessMessage(message: string): Locator {\n  return this.page.getByText(message).first();\n}\n// In test: await expect(page.getSuccessMessage('Success')).toBeVisible();\n```\n\n## Acceptance Criteria\n- [ ] `BasePage.ts` has no `expect()` calls\n- [ ] Assertion methods converted to locator-returning methods\n- [ ] Tests updated to use `await expect(pageObject.getX()).toBeVisible()` pattern\n- [ ] `assertions.ts` contains any shared assertion logic\n- [ ] All E2E tests pass after refactoring","acceptance_criteria":"## Acceptance Criteria\n- [ ] `BasePage.ts` has no `expect()` calls\n- [ ] Assertion methods converted to locator-returning methods\n- [ ] Tests updated to use `await expect(pageObject.getX()).toBeVisible()` pattern\n- [ ] `assertions.ts` contains any shared assertion logic\n- [ ] All E2E tests pass after refactoring","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-12T18:59:46.653884+01:00","created_by":"spartDev","updated_at":"2026-01-12T22:29:18.140128+01:00","closed_at":"2026-01-12T22:29:18.140128+01:00","close_reason":"Refactored BasePage.ts to use locator-returning methods instead of assertions. All 96 E2E tests and 1505 unit tests pass."}
{"id":"My-Prompt-Manager-2xi","title":"Document that findDuplicatePrompts progress values are normalized","description":"The onProgress callback in findDuplicatePrompts reports inflated completedComparisons values to ensure progress reaches 100%. The actual comparisons performed are lower due to bucketing optimization. Add JSDoc comment explaining this behavior for consumers of the callback.","status":"closed","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-20T17:51:17.648101+01:00","created_by":"spartDev","updated_at":"2026-01-20T18:05:17.353297+01:00","closed_at":"2026-01-20T18:05:17.353297+01:00","close_reason":"Implemented: 33 unit tests, JSDoc documentation, adaptive bucket range"}
{"id":"My-Prompt-Manager-2xq","title":"Add JSDoc comments for complex async functions","description":"**Location:** SiteIntegrationSection.tsx and SettingsView.tsx\n\n**Problem:** Complex async functions lack documentation:\n- handleExportCustomSite\n- handlePreviewImport\n- handleConfirmImport\n- startElementPicker\n- handleAddSite\n- saveSettings\n- notifyCustomSiteChange\n\n**Fix:** Add JSDoc comments:\n```typescript\n/**\n * Exports a custom site configuration to clipboard as encoded string.\n * Falls back to showing code in import field if clipboard access is blocked.\n * @param site - The custom site to export\n * @throws ConfigurationEncoderError if encoding fails\n */\nconst handleExportCustomSite = async (site: CustomSite) =\u003e {\n  // ...\n};\n\n/**\n * Validates and prepares imported configuration for preview.\n * Decodes the configuration, validates structure, checks for duplicates,\n * and identifies security warnings.\n */\nconst handlePreviewImport = async () =\u003e {\n  // ...\n};\n```\n\n**Impact:** LOW - Documentation and maintainability","status":"open","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T12:05:53.940669+01:00","created_by":"spartDev","updated_at":"2026-01-26T12:05:53.940669+01:00"}
{"id":"My-Prompt-Manager-2y4","title":"Update component type definitions","description":"Update src/types/components.ts: Remove onManageCategories from FilterSortControlsProps. Add FooterToolbarProps if not co-located with component.","status":"closed","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-13T22:44:57.758815+01:00","created_by":"spartDev","updated_at":"2026-01-20T22:03:42.062269+01:00","closed_at":"2026-01-20T22:03:42.062269+01:00","close_reason":"Deferred - Categories button removal reverted because FooterToolbar (replacement navigation) was never merged. Will revisit when feat/footer-toolbar-redesign is merged.","dependencies":[{"issue_id":"My-Prompt-Manager-2y4","depends_on_id":"My-Prompt-Manager-7m2","type":"blocks","created_at":"2026-01-13T22:45:11.598295+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-35h","title":"Extract shared utilities - eliminate copy-paste code","description":"ensureStorageAvailable is copy-pasted in storage.ts:684-701 AND UsageTracker.ts:92-109. withLock mutex pattern duplicated in storage.ts:779-817 AND UsageTracker.ts:199-232. This is DRY violation 101. Extract to src/utils/chromeStorage.ts and src/utils/asyncMutex.ts.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-19T23:29:46.671682+01:00","created_by":"spartDev","updated_at":"2026-01-20T17:19:04.87615+01:00","closed_at":"2026-01-20T17:19:04.87615+01:00","close_reason":"Extracted ensureStorageAvailable to chromeStorage.ts and AsyncMutex to asyncMutex.ts. Both services updated to use shared utilities.","dependencies":[{"issue_id":"My-Prompt-Manager-35h","depends_on_id":"My-Prompt-Manager-akm","type":"blocks","created_at":"2026-01-19T23:30:11.262587+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-35h","depends_on_id":"My-Prompt-Manager-2jr","type":"blocks","created_at":"2026-01-19T23:30:12.254368+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-36x","title":"Write tests for FooterToolbar component","description":"Create src/components/__tests__/FooterToolbar.test.tsx with tests for: rendering all buttons, click handlers, stats display, loading state, dark mode classes, accessibility attributes.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-13T22:44:58.737561+01:00","created_by":"spartDev","updated_at":"2026-01-14T16:32:43.479938+01:00","closed_at":"2026-01-14T16:32:43.479938+01:00","close_reason":"Tests already exist with comprehensive coverage - 25 tests covering rendering, click handlers, stats display, loading state, keyboard navigation, button titles, and styling","dependencies":[{"issue_id":"My-Prompt-Manager-36x","depends_on_id":"My-Prompt-Manager-vaf","type":"blocks","created_at":"2026-01-13T22:45:12.564024+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-36x","depends_on_id":"My-Prompt-Manager-egu","type":"blocks","created_at":"2026-01-13T22:45:12.657982+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-3a2","title":"Memoize storage calculation in DataStorageSection","description":"**Location:** DataStorageSection.tsx:164-166\n\n**Problem:** JSON.stringify runs on every render:\n```typescript\nconst storageUsed = JSON.stringify({ prompts, categories }).length;\nconst storageMax = 5 * 1024 * 1024;\nconst storagePercentage = Math.min((storageUsed / storageMax) * 100, 100);\n```\n\n**Fix:**\n```typescript\nconst storageUsed = useMemo(\n  () =\u003e JSON.stringify({ prompts, categories }).length,\n  [prompts, categories]\n);\nconst storagePercentage = useMemo(\n  () =\u003e Math.min((storageUsed / storageMax) * 100, 100),\n  [storageUsed]\n);\n```\n\n**Impact:** HIGH - JSON.stringify is expensive, especially with large prompt collections","status":"open","priority":1,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:23:19.785175+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:23:19.785175+01:00"}
{"id":"My-Prompt-Manager-3l8","title":"Create analytics-tab.spec.ts E2E tests","description":"Create tests/e2e/analytics/analytics-tab.spec.ts. Test scenarios: renders analytics tab, empty state, summary cards (total uses, top platform, top category), top prompts list (sorted, trophy icons), FAB visibility (sidepanel vs popup, with/without data), back navigation.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-16T13:26:09.767226+01:00","created_by":"spartDev","updated_at":"2026-01-16T14:50:30.949547+01:00","closed_at":"2026-01-16T14:50:30.949547+01:00","close_reason":"Created E2E test files with comprehensive test coverage","dependencies":[{"issue_id":"My-Prompt-Manager-3l8","depends_on_id":"My-Prompt-Manager-6rp","type":"blocks","created_at":"2026-01-16T13:26:20.57824+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-3l8","depends_on_id":"My-Prompt-Manager-1dn","type":"blocks","created_at":"2026-01-16T13:26:20.665799+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-3l8","depends_on_id":"My-Prompt-Manager-d70","type":"blocks","created_at":"2026-01-16T13:26:20.753927+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-3l8","depends_on_id":"My-Prompt-Manager-bpx","type":"blocks","created_at":"2026-01-16T13:26:20.845013+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-3l8","depends_on_id":"My-Prompt-Manager-1lg","type":"blocks","created_at":"2026-01-16T13:26:20.937659+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-3lb","title":"Remove redundant onKeyDown handlers from native buttons","description":"Several components have redundant onKeyDown handlers on native button elements that already handle Enter/Space natively:\n\n**Locations:**\n- src/components/LibraryView.tsx:187-192 (floating add button)\n- src/components/PromptCard.tsx:170-175 (copy button)\n- src/components/PromptCard.tsx:193-198 (share button)\n\n**Current:**\n```tsx\n\u003cbutton\n  onClick={handleClick}\n  onKeyDown={(e) =\u003e {\n    if (e.key === 'Enter' || e.key === ' ') {\n      e.preventDefault();\n      handleClick();\n    }\n  }}\n\u003e\n```\n\n**Fix:** Remove the onKeyDown handlers - native buttons handle this automatically.\n\n## Acceptance Criteria\n\n- [ ] Redundant `onKeyDown` handler removed from floating add button in LibraryView.tsx\n- [ ] Redundant `onKeyDown` handler removed from copy button in PromptCard.tsx\n- [ ] Redundant `onKeyDown` handler removed from share button in PromptCard.tsx\n- [ ] All affected buttons still respond to Enter and Space keys (manual keyboard testing)\n- [ ] Click functionality unchanged\n- [ ] All existing tests pass (`npm test`)\n- [ ] No TypeScript errors (`npm run typecheck`)\n- [ ] Linting passes (`npm run lint`)","status":"closed","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-23T21:45:30.353362+01:00","created_by":"spartDev","updated_at":"2026-01-24T07:15:09.434183+01:00","closed_at":"2026-01-24T07:15:09.434183+01:00","close_reason":"PR #300 created: removed redundant onKeyDown handlers from 3 native buttons"}
{"id":"My-Prompt-Manager-3w4","title":"Replace SVG path selectors with data-testid attributes","description":"## Problem\nClose and back buttons are identified using SVG path data selectors which are extremely fragile. Any icon library update or SVG optimization will break these selectors.\n\n## Current Issues\n- `BasePage.ts:66-69` uses `path[d=\"M6 18L18 6M6 6l12 12\"]` for close button\n- `BasePage.ts:75-78` uses `path[d=\"M10 19l-7-7m0 0l7-7m-7 7h18\"]` for back button\n- Same pattern in `selectors.ts:74-75` and multiple test files\n- SVG paths can change with icon updates, library changes, or optimizations\n\n## Solution\nAdd `data-testid` attributes to close/back buttons in React components and use `getByTestId()` in tests.\n\n## Files to Modify\n**React Components:**\n- Add `data-testid=\"close-modal\"` to modal close buttons\n- Add `data-testid=\"back-button\"` to navigation back buttons\n\n**Test Files:**\n- `tests/e2e/pages/BasePage.ts`\n- `tests/e2e/utils/selectors.ts`\n- Any test files using SVG path selectors","acceptance_criteria":"## Acceptance Criteria\n- [ ] Close buttons have `data-testid=\"close-modal\"` attribute\n- [ ] Back buttons have `data-testid=\"back-button\"` attribute\n- [ ] `playwright.config.ts` has `testIdAttribute: 'data-testid'` configured\n- [ ] `BasePage.ts` uses `getByTestId()` instead of SVG path selectors\n- [ ] No SVG `path[d=\"...\"]` selectors remain in test code\n- [ ] All E2E tests pass after refactoring","status":"closed","priority":1,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-12T18:59:41.936528+01:00","created_by":"spartDev","updated_at":"2026-01-12T21:49:01.700532+01:00","closed_at":"2026-01-12T21:49:01.700532+01:00","close_reason":"Replaced all SVG path selectors with data-testid attributes. All 1505 tests pass."}
{"id":"My-Prompt-Manager-44w","title":"Hoist variantStyles to module scope in ConfirmDialog","description":"ConfirmDialog.tsx recreates variantStyles object with JSX elements on every render (lines 73-101). Per Vercel best practice `rendering-hoist-jsx`, static JSX should be hoisted to module scope.\n\n**Location:** src/components/ConfirmDialog.tsx:73-101\n\n**Impact:** Avoids recreating JSX elements (SVG icons) on every render.\n\n**Fix:** Move variantStyles object outside the component as a module-level constant.\n\n## Acceptance Criteria\n\n- [ ] `variantStyles` object is moved to module scope (outside the component function)\n- [ ] All SVG icons within variantStyles are properly typed\n- [ ] Object is typed as `Record\u003cConfirmDialogVariant, VariantStyle\u003e` or equivalent\n- [ ] No JSX is recreated inside the component that could be hoisted\n- [ ] All dialog variants (danger, warning, info) render correctly (manual verification)\n- [ ] All existing ConfirmDialog tests pass (`npm test src/components/ConfirmDialog`)\n- [ ] No TypeScript errors (`npm run typecheck`)\n- [ ] Linting passes (`npm run lint`)","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-23T21:45:04.19118+01:00","created_by":"spartDev","updated_at":"2026-01-23T22:03:14.680481+01:00","closed_at":"2026-01-23T22:03:14.680481+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-4bz","title":"Add unit tests for findDuplicatePrompts safeguards","description":"PR #253 added safeguards to findDuplicatePrompts but no unit tests. Need tests for:\n- Prompt count limit enforcement (throws when \u003e maxPrompts without allowLargeDatasets)\n- allowLargeDatasets bypass (processes large collections when true)\n- Timeout behavior (throws after timeoutMs)\n- Progress reporting accuracy after bucketing optimization\n- Length bucket edge cases at bucket boundaries (e.g., 199-char vs 201-char prompts)","status":"closed","priority":1,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-20T17:51:16.663278+01:00","created_by":"spartDev","updated_at":"2026-01-20T18:05:17.350313+01:00","closed_at":"2026-01-20T18:05:17.350313+01:00","close_reason":"Implemented: 33 unit tests, JSDoc documentation, adaptive bucket range"}
{"id":"My-Prompt-Manager-4d6","title":"Fix double comparisons in duplicate detection bucket filter","description":"getCandidatesFromBuckets returns all prompts in adjacent buckets not in processedIds, but processedIds only populates when duplicates are found. This causes each pair to be compared twice in the common no-duplicate case, doubling work and making the 10s timeout more likely to trigger.\n\nFix: Store original index in buckets and filter candidates to only include prompts with index \u003e currentIndex, restoring the original forward-only comparison behavior.","status":"closed","priority":1,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-20T19:49:23.481171+01:00","created_by":"spartDev","updated_at":"2026-01-20T19:52:09.739981+01:00","closed_at":"2026-01-20T19:52:09.739981+01:00","close_reason":"Fixed: store index in buckets, filter candidates by index \u003e currentIndex for forward-only comparison"}
{"id":"My-Prompt-Manager-4lq","title":"Footer Toolbar Redesign","description":"Consolidate Analytics, Categories, and Settings buttons into a unified footer toolbar. Improves discoverability while respecting 400px width constraint. See docs/plans/footer-toolbar-redesign.md for full plan.","status":"closed","priority":2,"issue_type":"feature","owner":"roux.tom@gmail.com","created_at":"2026-01-13T22:44:39.082024+01:00","created_by":"spartDev","updated_at":"2026-01-14T16:55:11.218043+01:00","closed_at":"2026-01-14T16:55:11.218043+01:00","close_reason":"Feature complete: FooterToolbar component implemented, integrated into LibraryView, all tests passing (1711), manual verification confirmed."}
{"id":"My-Prompt-Manager-4y3","title":"Memoize getEnabledTypes in NotificationSection","description":"**Location:** NotificationSection.tsx:97-105\n\n**Problem:** getEnabledTypes function recreated every render:\n```typescript\nconst getEnabledTypes = () =\u003e {\n  const types = settings?.enabledTypes;\n  return {\n    success: types?.success ?? true,\n    error: types?.error ?? true,\n    info: types?.info ?? true,\n    warning: types?.warning ?? true\n  };\n};\nconst currentEnabledTypes = getEnabledTypes();\n```\n\n**Fix:** Use useMemo directly:\n```typescript\nconst currentEnabledTypes = useMemo(() =\u003e ({\n  success: settings?.enabledTypes?.success ?? true,\n  error: settings?.enabledTypes?.error ?? true,\n  info: settings?.enabledTypes?.info ?? true,\n  warning: settings?.enabledTypes?.warning ?? true\n}), [settings?.enabledTypes]);\n```\n\n**Impact:** MEDIUM - Unnecessary object creation on each render","status":"open","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:24:21.754124+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:24:21.754124+01:00"}
{"id":"My-Prompt-Manager-59u","title":"Memoize handleReset in AboutSection","description":"**Location:** AboutSection.tsx:15-29\n\n**Problem:** handleReset function is not memoized:\n```typescript\nconst handleReset = async () =\u003e {\n  if (!showResetConfirm) {\n    setShowResetConfirm(true);\n    return;\n  }\n  setResetting(true);\n  try {\n    await onReset();\n    setShowResetConfirm(false);\n  } catch (error) {\n    Logger.error('Failed to reset settings', toError(error));\n  } finally {\n    setResetting(false);\n  }\n};\n```\n\n**Fix:** Use useCallback:\n```typescript\nconst handleReset = useCallback(async () =\u003e {\n  if (!showResetConfirm) {\n    setShowResetConfirm(true);\n    return;\n  }\n  // ... rest\n}, [showResetConfirm, onReset]);\n```\n\n**Impact:** MEDIUM - Function recreated on every render","status":"open","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:25:00.342626+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:25:00.342626+01:00"}
{"id":"My-Prompt-Manager-5g1","title":"Hoist SVG icons to module scope in ThemeToggle.tsx","description":"**Context**: ThemeToggle.tsx creates sun and moon SVG icons inline, causing recreation on every render.\n\n**Work Required**:\n- Extract moon icon SVG to module-scope constant\n- Extract sun icon SVG to module-scope constant\n- Update render to use hoisted constants\n\n**Acceptance Criteria**:\n- [ ] Moon icon SVG is defined at module scope\n- [ ] Sun icon SVG is defined at module scope\n- [ ] Icons still have correct styling (colors, sizes)\n- [ ] Theme toggle functionality unchanged\n- [ ] npm run lint passes\n- [ ] npm run typecheck passes","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-24T22:39:33.553863+01:00","created_by":"spartDev","updated_at":"2026-01-24T22:58:37.131237+01:00","closed_at":"2026-01-24T22:58:37.131237+01:00","close_reason":"Hoisted MoonIcon and SunIcon SVGs to module scope in ThemeToggle.tsx. PR #307"}
{"id":"My-Prompt-Manager-5v9","title":"Consider direct imports instead of barrel file in hooks/index.ts","description":"Per Vercel bundle-barrel-imports rule, barrel files can hurt tree-shaking.\n\nModern bundlers handle this well, but direct imports are more explicit and guaranteed to tree-shake properly.\n\n**Low priority** - only address if bundle size becomes a concern.","status":"closed","priority":4,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-20T22:33:41.471448+01:00","created_by":"spartDev","updated_at":"2026-01-22T21:42:14.920451+01:00","closed_at":"2026-01-22T21:42:14.920451+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-5wv","title":"Deacon Patrol","description":"Mayor's daemon patrol loop for handling callbacks, health checks, and cleanup.","status":"closed","priority":2,"issue_type":"molecule","owner":"roux.tom@gmail.com","created_at":"2026-01-18T22:34:32.498301+01:00","created_by":"spartDev","updated_at":"2026-01-23T14:57:41.283047+01:00","closed_at":"2026-01-23T14:57:41.283047+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-666","title":"Simplify ViewHeader in LibraryView","description":"Update LibraryView to remove AnalyticsButton and SettingsButton from ViewHeader.Actions. Only CloseButton should remain for sidepanel context. Navigation moves to FooterToolbar.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-13T22:44:55.82073+01:00","created_by":"spartDev","updated_at":"2026-01-14T16:42:02.850523+01:00","closed_at":"2026-01-14T16:42:02.850523+01:00","close_reason":"Removed AnalyticsButton and SettingsButton from ViewHeader.Actions in LibraryView. Only CloseButton remains for sidepanel context. Updated LibraryView.test.tsx and App.analytics.test.tsx to reflect the change. All tests pass.","dependencies":[{"issue_id":"My-Prompt-Manager-666","depends_on_id":"My-Prompt-Manager-egu","type":"blocks","created_at":"2026-01-13T22:45:11.504823+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-66b","title":"Add type guard to getChromeMock helper","description":"getChromeMock() (test-helpers.ts:86) uses type assertion without guard. Should use isGlobalWithMocks guard for safety or document why assertion is safe.","status":"closed","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-21T18:48:52.00196+01:00","created_by":"spartDev","updated_at":"2026-01-22T21:13:02.012762+01:00","closed_at":"2026-01-22T21:13:02.012762+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-6ic","title":"Memoize or hoist highlightText function in PromptCard","description":"PromptCard.tsx defines highlightText function inside the component (lines 25-63), causing it to be recreated on every render. Per Vercel best practice `rerender-memo`, this should be optimized.\n\n**Location:** src/components/PromptCard.tsx:25-63\n\n**Options:**\n1. Hoist to module scope (it's a pure function that only depends on its arguments)\n2. Wrap in useCallback with [prompt.id] dependency\n\n**Recommendation:** Hoist to module scope since it's a pure text transformation function:\n```typescript\nconst highlightText = (text: string, query: string, promptId: string): ReactNode =\u003e {\n  // ...\n};\n```\n\n## Acceptance Criteria\n\n- [ ] `highlightText` function is moved outside the PromptCard component to module scope\n- [ ] Function signature remains unchanged: `(text: string, query: string, promptId: string) =\u003e ReactNode`\n- [ ] Function is exported only if needed elsewhere, otherwise kept as module-private\n- [ ] All existing tests pass (`npm test`)\n- [ ] Search highlighting still works correctly in the UI (manual verification)\n- [ ] No TypeScript errors (`npm run typecheck`)\n- [ ] Linting passes (`npm run lint`)","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-23T21:45:06.953026+01:00","created_by":"spartDev","updated_at":"2026-01-24T11:53:53.708562+01:00","closed_at":"2026-01-24T11:53:53.708562+01:00","close_reason":"PR merged"}
{"id":"My-Prompt-Manager-6jp","title":"Deduplicate SortOrder/SortDirection type definitions","description":"SortOrder and SortDirection are defined twice - inline in Settings interface (index.ts:31-32) and as separate types (index.ts:38-39). Settings should reference the type aliases.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-21T18:48:45.162816+01:00","created_by":"spartDev","updated_at":"2026-01-22T13:58:49.342394+01:00","closed_at":"2026-01-22T13:58:49.342394+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-6k6","title":"Replace custom useDarkMode with ThemeProvider in analytics.tsx","description":"## Task\nRefactor analytics.tsx to use the same theme system as the rest of the app.\n\n## Changes Required\n1. Import ThemeProvider and useThemeContext from contexts/ThemeContext\n2. Remove the custom useDarkMode hook (lines 11-37)\n3. Wrap AnalyticsPage in ThemeProvider\n4. Use useThemeContext().resolvedTheme to get isDarkMode value\n5. Remove manual dark class manipulation (handled by useTheme)\n\n## Acceptance Criteria\n- Analytics page respects user theme preference from settings\n- Switching theme in settings immediately updates analytics page\n- System theme preference still works when user has 'system' selected","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-13T17:43:25.92746+01:00","created_by":"spartDev","updated_at":"2026-01-13T17:47:05.298668+01:00","closed_at":"2026-01-13T17:47:05.298668+01:00","close_reason":"Refactored analytics.tsx to use ThemeProvider instead of custom useDarkMode hook"}
{"id":"My-Prompt-Manager-6rp","title":"Create AnalyticsPage POM","description":"Create tests/e2e/pages/AnalyticsPage.ts extending BasePage. Include methods: navigateToAnalyticsTab, openFullDashboard, getSummaryCard, getTopPromptsSection, getTopPromptItems, getExpandDashboardButton, getClearHistoryButton, getClearHistoryModal, getTab, switchTab, confirmClearHistory. Follow existing POM pattern - return Locators not assertions.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-16T13:26:05.269982+01:00","created_by":"spartDev","updated_at":"2026-01-16T14:37:47.585405+01:00","closed_at":"2026-01-16T14:37:47.585405+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-6uk","title":"Fix sequential async in SiteIntegrationSection notifyCustomSiteChange","description":"**Location:** SiteIntegrationSection.tsx:320-341\n\n**Problem:** notifyCustomSiteChange has same waterfall pattern as SettingsView:\n```typescript\nfor (const tab of tabs) {\n  if (tab.id) {\n    try {\n      await chrome.tabs.sendMessage(tab.id, {...});  // Sequential!\n    } catch {}\n  }\n}\n```\n\n**Fix:** Use Promise.allSettled() for parallel execution.\n\n**Impact:** CRITICAL - Network latency adds up with each sequential await","status":"open","priority":0,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:22:42.739596+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:22:42.739596+01:00"}
{"id":"My-Prompt-Manager-79d","title":"Remove unused timeoutRef in useToast","description":"useToast.ts:25 - timeoutRef is declared but never used to auto-dismiss toasts.\n\n```typescript\nconst timeoutRef = useRef\u003cNodeJS.Timeout | null\u003e(null);\n```\n\nEither implement auto-dismiss using this ref or remove the dead code.","status":"closed","priority":1,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-20T22:33:24.086058+01:00","created_by":"spartDev","updated_at":"2026-01-21T09:23:13.751064+01:00","closed_at":"2026-01-21T09:23:13.751064+01:00","close_reason":"Removed unused timeoutRef and related cleanup code. Auto-dismiss is handled by Toast components, not the hook."}
{"id":"My-Prompt-Manager-79e","title":"Create analytics-clear-history.spec.ts E2E tests","description":"Create tests/e2e/analytics/analytics-clear-history.spec.ts. Test scenarios: modal opens on click, shows warning, cancel closes without clearing, backdrop closes modal, confirm removes all history, loading state, storage cleared, FAB hides after clear, button only visible with data.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-16T13:26:11.563191+01:00","created_by":"spartDev","updated_at":"2026-01-16T14:50:30.97112+01:00","closed_at":"2026-01-16T14:50:30.97112+01:00","close_reason":"Created E2E test files with comprehensive test coverage","dependencies":[{"issue_id":"My-Prompt-Manager-79e","depends_on_id":"My-Prompt-Manager-6rp","type":"blocks","created_at":"2026-01-16T13:26:23.078351+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-79e","depends_on_id":"My-Prompt-Manager-1dn","type":"blocks","created_at":"2026-01-16T13:26:23.170129+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-79e","depends_on_id":"My-Prompt-Manager-d70","type":"blocks","created_at":"2026-01-16T13:26:23.261618+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-79e","depends_on_id":"My-Prompt-Manager-bpx","type":"blocks","created_at":"2026-01-16T13:26:23.350782+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-79e","depends_on_id":"My-Prompt-Manager-1lg","type":"blocks","created_at":"2026-01-16T13:26:23.437143+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-7be","title":"Move View Full Dashboard button to footer","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-13T13:51:25.365895+01:00","created_by":"spartDev","updated_at":"2026-01-13T14:43:10.699075+01:00","closed_at":"2026-01-13T14:43:10.699075+01:00","close_reason":"Closed","dependencies":[{"issue_id":"My-Prompt-Manager-7be","depends_on_id":"My-Prompt-Manager-0n5","type":"blocks","created_at":"2026-01-13T13:52:41.089325+01:00","created_by":"spartDev"}],"comments":[{"id":2,"issue_id":"My-Prompt-Manager-7be","author":"spartDev","text":"Add a footer section after main in AnalyticsTab.tsx similar to LibraryView:171-182. Move the View Full Dashboard button from header to footer with stats display. Show only when hasData and onExpandDashboard and context is sidepanel.","created_at":"2026-01-13T12:52:31Z"}]}
{"id":"My-Prompt-Manager-7bn","title":"Replace inline arrow functions with useCallback in SettingsView","description":"**Location:** SettingsView.tsx:471-514\n\n**Problem:** Multiple inline arrow functions create new references on every render:\n```typescript\nonInterfaceModeChange={(mode) =\u003e void handleInterfaceModeChange(mode)}\nonSiteToggle={(hostname, enabled) =\u003e { handleSiteToggle(hostname, enabled); }}\nonCustomSiteToggle={(hostname, enabled) =\u003e void handleCustomSiteToggle(hostname, enabled)}\nonRemoveCustomSite={(hostname) =\u003e void handleRemoveCustomSite(hostname)}\nonAddCustomSite={(siteData) =\u003e void handleAddCustomSite(siteData as Omit\u003cCustomSite, 'dateAdded'\u003e)}\n```\n\n**Fix:** Use useCallback for handlers or pass handlers directly if signatures match.\n\n**Impact:** HIGH - Causes unnecessary re-renders of child components","status":"open","priority":1,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:23:18.910183+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:23:18.910183+01:00"}
{"id":"My-Prompt-Manager-7es","title":"Create custom hook for picker window state","description":"**Location:** SiteIntegrationSection.tsx:284-290, 298-328, 331-352\n\n**Problem:** Picker window logic is scattered throughout component:\n- URL params parsing (284-290)\n- Message listener effect (298-328)\n- Auto-populate effect (331-352)\n\n**Fix:** Extract to custom hook:\n```typescript\n// src/hooks/usePickerWindow.ts\ninterface PickerWindowState {\n  isPickerWindow: boolean;\n  originalTabId: number | null;\n  originalUrl: string | null;\n  originalHostname: string | null;\n}\n\ninterface PickerResult {\n  selector: string;\n  fingerprint: ElementFingerprint | null;\n}\n\nexport function usePickerWindow(): {\n  state: PickerWindowState;\n  pickerResult: PickerResult | null;\n  clearPickerResult: () =\u003e void;\n} {\n  const state = useMemo(() =\u003e {\n    const params = new URLSearchParams(window.location.search);\n    return {\n      isPickerWindow: params.get('picker') === 'true',\n      originalTabId: params.get('originalTabId') ? parseInt(params.get('originalTabId')\\!, 10) : null,\n      originalUrl: params.get('originalUrl'),\n      originalHostname: params.get('originalHostname')\n    };\n  }, []);\n\n  const [pickerResult, setPickerResult] = useState\u003cPickerResult | null\u003e(null);\n\n  useEffect(() =\u003e {\n    const handleMessage = (message: { type?: string; data?: unknown }) =\u003e {\n      if (message.type === 'ELEMENT_PICKER_RESULT') {\n        // ...\n      }\n    };\n    chrome.runtime.onMessage.addListener(handleMessage);\n    return () =\u003e chrome.runtime.onMessage.removeListener(handleMessage);\n  }, []);\n\n  return { state, pickerResult, clearPickerResult: () =\u003e setPickerResult(null) };\n}\n```\n\n**Impact:** LOW - Code organization, reusability","status":"open","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T12:06:00.075877+01:00","created_by":"spartDev","updated_at":"2026-01-26T12:06:00.075877+01:00"}
{"id":"My-Prompt-Manager-7m2","title":"Simplify FilterSortControls - remove Categories button","description":"Remove Categories button and onManageCategories prop from FilterSortControls. Component should only handle filtering and sorting, not navigation. Update memoization comparison function.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-13T22:44:54.872801+01:00","created_by":"spartDev","updated_at":"2026-01-14T16:12:20.81385+01:00","closed_at":"2026-01-14T16:12:20.81385+01:00","close_reason":"Removed Categories button and onManageCategories prop from FilterSortControls. Updated type definitions, component usages in App.tsx and LibraryView.tsx, and removed related tests."}
{"id":"My-Prompt-Manager-7qa","title":"Convert ErrorType enum to string union","description":"ErrorType enum (index.ts:138-145) could be string union for better tree-shaking. Enums compile to objects at runtime while unions are erased.","status":"closed","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-21T18:48:48.122031+01:00","created_by":"spartDev","updated_at":"2026-01-22T21:41:39.276582+01:00","closed_at":"2026-01-22T21:41:39.276582+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-7r8","title":"Add test coverage for ThemeToggle.tsx","description":"**Context**: ThemeToggle.tsx has no dedicated test file. While useTheme has tests, ThemeToggle component behavior isn't directly tested.\n\n**Work Required**:\n- Create ThemeToggle.test.tsx with component tests\n\n**Test Scenarios Required**:\n1. Renders moon icon when in light mode\n2. Renders sun icon when in dark mode\n3. Calls setTheme with 'dark' when clicking in light mode\n4. Calls setTheme with 'light' when clicking in dark mode\n5. Has correct aria-label based on current theme\n6. Handles theme change errors gracefully\n\n**Acceptance Criteria**:\n- [ ] ThemeToggle.test.tsx exists with 5+ test cases\n- [ ] Tests verify correct icon rendering per theme\n- [ ] Tests verify click handler behavior\n- [ ] Tests verify accessibility attributes\n- [ ] Tests mock ThemeContext properly\n- [ ] All tests pass with npm test\n- [ ] npm run lint passes","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-24T22:39:34.521009+01:00","created_by":"spartDev","updated_at":"2026-01-25T21:45:39.9218+01:00","closed_at":"2026-01-25T21:45:39.9218+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-7u4","title":"Add bottom padding to scrollable content for FAB clearance","description":"Add pb-16 (bottom padding) to the scrollable main content area to prevent content from being hidden behind the floating button","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-16T12:41:41.811429+01:00","created_by":"spartDev","updated_at":"2026-01-16T12:46:29.050989+01:00","closed_at":"2026-01-16T12:46:29.050989+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-81u","title":"Witness Patrol","description":"Per-rig worker monitor patrol loop with progressive nudging.","status":"closed","priority":2,"issue_type":"molecule","owner":"roux.tom@gmail.com","created_at":"2026-01-18T22:34:32.736073+01:00","created_by":"spartDev","updated_at":"2026-01-23T14:57:46.359967+01:00","closed_at":"2026-01-23T14:57:46.359967+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-8jz","title":"Analytics page ignores user theme preference from settings","description":"## Bug Description\nAnalytics page (src/analytics.html) always shows dark mode when OS is in dark mode, even if user explicitly set Light mode in extension settings.\n\n## Root Cause\nThe `analytics.tsx` file has its own `useDarkMode` hook (lines 11-37) that only checks `prefers-color-scheme` media query. It does NOT read the user's theme preference from Chrome storage.\n\nMeanwhile, the main popup uses `ThemeProvider` → `useTheme` which:\n1. Reads user's theme preference from Chrome storage ('light', 'dark', or 'system')\n2. Respects user's explicit choice\n\n## Expected Behavior\nAnalytics page should respect the user's theme preference from extension settings, same as popup does.\n\n## Affected Files\n- src/analytics.tsx - Has its own useDarkMode that ignores storage settings\n- src/hooks/useTheme.ts - The correct implementation used by popup\n- src/contexts/ThemeContext.tsx - ThemeProvider used by popup","status":"closed","priority":2,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-13T17:43:17.388333+01:00","created_by":"spartDev","updated_at":"2026-01-13T17:56:27.456648+01:00","closed_at":"2026-01-13T17:56:27.456648+01:00","close_reason":"Both dependencies complete - analytics now uses ThemeProvider and body has dark mode background","dependencies":[{"issue_id":"My-Prompt-Manager-8jz","depends_on_id":"My-Prompt-Manager-6k6","type":"blocks","created_at":"2026-01-13T17:43:40.893564+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-8jz","depends_on_id":"My-Prompt-Manager-m0l","type":"blocks","created_at":"2026-01-13T17:43:40.983382+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-8q8","title":"Consider adaptive HASH_BUCKET_SIZE for duplicate detection","description":"Currently HASH_BUCKET_SIZE is fixed at 100 characters. For prompt libraries with very short or very long prompts on average, an adaptive bucket size based on the collection's average prompt length could improve bucketing efficiency. This is a future optimization to consider.","status":"closed","priority":4,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-20T17:51:18.637974+01:00","created_by":"spartDev","updated_at":"2026-01-20T18:05:17.355384+01:00","closed_at":"2026-01-20T18:05:17.355384+01:00","close_reason":"Implemented: 33 unit tests, JSDoc documentation, adaptive bucket range"}
{"id":"My-Prompt-Manager-8qs","title":"Use useReducer for SiteIntegrationSection state management","description":"**Location:** SiteIntegrationSection.tsx:50-74\n\n**Problem:** 25 useState calls creating state explosion:\n```typescript\nconst [showAddSite, setShowAddSite] = useState(false);\nconst [newSiteUrl, setNewSiteUrl] = useState('');\nconst [newSiteName, setNewSiteName] = useState('');\n// ... 22 more useState calls\n```\n\n**Fix:** Group related state with useReducer:\n```typescript\ninterface AddSiteFormState {\n  url: string;\n  name: string;\n  selector: string;\n  fingerprint: ElementFingerprint | null;\n  placement: 'before' | 'after' | 'inside-start' | 'inside-end';\n  offsetX: number;\n  offsetY: number;\n  zIndex: number;\n  description: string;\n  error: string;\n  isAdding: boolean;\n}\n\ninterface ImportState {\n  code: string;\n  error: string | null;\n  isImporting: boolean;\n  isConfirming: boolean;\n  pendingImport: PendingImport | null;\n}\n```\n\n**Impact:** CRITICAL - Reduces complexity, prevents bugs, improves testability","status":"open","priority":0,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:22:44.514747+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:22:44.514747+01:00"}
{"id":"My-Prompt-Manager-92g","title":"Refactor interactive label anti-pattern in ColorPicker","description":"## Location\nsrc/components/ColorPicker.tsx:137-148 (and duplicate at 214-226)\n\n## Problem\nThe component makes a label element interactive with onClick, onKeyDown, and tabIndex. This is an accessibility anti-pattern requiring eslint-disable comments.\n\n## Why This Exists\nThe native color input is hidden with sr-only, and the label acts as a visible trigger.\n\n## Better Approach\nUse a button that triggers the hidden input:\n```tsx\n\u003cbutton\n  type=\"button\"\n  onClick={() =\u003e document.getElementById(colorInputId)?.click()}\n  className=\"...\"\n\u003e\n  \u003csvg\u003e...\u003c/svg\u003e\n  \u003cspan\u003ePick Custom Color\u003c/span\u003e\n\u003c/button\u003e\n\u003cinput id={colorInputId} type=\"color\" className=\"sr-only\" ... /\u003e\n```\n\n## Impact\n- Accessibility improvement\n- Removes eslint-disable comments\n- Cleaner semantic HTML","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-23T10:29:40.058424+01:00","created_by":"spartDev","updated_at":"2026-01-23T15:16:05.940066+01:00","closed_at":"2026-01-23T15:16:05.940066+01:00","close_reason":"Already fixed in commit 3f6f2cd (PR #285). ColorPicker.tsx now uses proper button elements instead of interactive labels, with no eslint-disable comments."}
{"id":"My-Prompt-Manager-9cr","title":"Optimize tab iteration in useTheme","description":"useTheme.ts:91-102 - Iterates ALL browser tabs to send theme change message.\n\n```typescript\nchrome.tabs.query({}, (tabs) =\u003e {\n  tabs.forEach((tab) =\u003e {  // ❌ forEach on potentially large array\n```\n\n**Consider:** \n- Using for...of for early exit capability\n- Limiting to active tabs\n- Using broadcast channel instead","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-20T22:33:40.444159+01:00","created_by":"spartDev","updated_at":"2026-01-21T14:52:52.081628+01:00","closed_at":"2026-01-21T14:52:52.081628+01:00","close_reason":"Optimized tab iteration: query only content script URLs, use for...of"}
{"id":"My-Prompt-Manager-9mf","title":"useTheme: Memoize resolvedTheme computation","description":"**Location**: useTheme.ts:86\n\n**Problem**: getSystemTheme() queries window.matchMedia on every render when theme is 'system'.\n\n**Current code**:\n```tsx\nconst resolvedTheme = theme === 'system' ? getSystemTheme() : theme;\n```\n\n**Fix**: Memoize the computation:\n```tsx\nconst resolvedTheme = useMemo(\n  () =\u003e theme === 'system' ? getSystemTheme() : theme,\n  [theme, getSystemTheme]\n);\n```","status":"closed","priority":2,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-21T16:35:41.559766+01:00","created_by":"spartDev","updated_at":"2026-01-21T16:46:40.952701+01:00","closed_at":"2026-01-21T16:46:40.952701+01:00","close_reason":"Memoized resolvedTheme computation with useMemo to prevent unnecessary window.matchMedia queries on every render"}
{"id":"My-Prompt-Manager-a2x","title":"Hoist static SVG previews in InterfaceModeSelector","description":"InterfaceModeSelector.tsx has two large inline SVGs (~20 lines each) for visual previews (lines 73-95, 152-174). Per Vercel best practice `rendering-hoist-jsx`, these static elements should be hoisted to module scope.\n\n**Location:** src/components/InterfaceModeSelector.tsx:73-95, 152-174\n\n**Also:** Duplicate selection indicator JSX (lines 61-69, 140-148) should be extracted to a component or constant.\n\n**Fix:** Extract SVGs and selection indicator to module-level constants or small components.\n\n## Acceptance Criteria\n\n- [ ] Popup preview SVG is hoisted to a module-level constant (e.g., `POPUP_PREVIEW_SVG`)\n- [ ] Side panel preview SVG is hoisted to a module-level constant (e.g., `SIDE_PANEL_PREVIEW_SVG`)\n- [ ] Selection indicator is either extracted to a shared component or module constant\n- [ ] No JSX is created inside the component that could be hoisted\n- [ ] Visual appearance is identical before and after changes (manual verification)\n- [ ] All existing tests pass (`npm test`)\n- [ ] No TypeScript errors (`npm run typecheck`)\n- [ ] Linting passes (`npm run lint`)","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-23T21:45:05.117654+01:00","created_by":"spartDev","updated_at":"2026-01-23T21:58:27.488542+01:00","closed_at":"2026-01-23T21:58:27.488542+01:00","close_reason":"PR #293 created"}
{"id":"My-Prompt-Manager-aaz","title":"Add test coverage for StorageWarning.tsx","description":"**Context**: StorageWarning.tsx has no test coverage. This is a HIGH priority issue.\n\n**Work Required**:\n- Create StorageWarning.test.tsx with comprehensive tests\n\n**Test Scenarios Required**:\n1. Renders with each warning level (safe, warning, critical, danger)\n2. Displays correct storage percentage\n3. Formats bytes correctly (KB, MB, GB)\n4. Shows 'Clear All Data' button only at danger level\n5. Confirmation dialog appears on clear button click\n6. Calls onClose after clearing data\n7. Loading state during clear operation\n\n**Acceptance Criteria**:\n- [ ] StorageWarning.test.tsx exists with 7+ test cases\n- [ ] Tests cover all 4 warning levels\n- [ ] Tests verify storage info display and formatting\n- [ ] Tests verify clear data confirmation flow\n- [ ] Tests mock StorageManager.getInstance() properly\n- [ ] All tests pass with npm test\n- [ ] npm run lint passes","status":"closed","priority":1,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-24T22:39:32.618156+01:00","created_by":"spartDev","updated_at":"2026-01-25T21:38:07.449923+01:00","closed_at":"2026-01-25T21:38:07.449923+01:00","close_reason":"Added comprehensive test coverage for StorageWarning.tsx with 29 tests covering warning levels, byte formatting, progress bar/icon colors, Clear All Data button visibility, confirmation dialog flow, Continue button, loading state, and error handling."}
{"id":"My-Prompt-Manager-abq","title":"Hoist static JSX elements outside components","description":"**Location:** Multiple files\n\n**Problem:** Static JSX elements are recreated on every render (Vercel rule: rendering-hoist-jsx):\n\n1. SettingsView.tsx:58-70 - SectionSeparator component\n2. AppearanceSection.tsx:22-26 - icon variable\n3. DataStorageSection.tsx:26-29 - icon variable\n4. NotificationSection.tsx - icon in section header\n5. AboutSection.tsx - multiple inline SVG icons\n\n**Fix:** Hoist static JSX outside components:\n```typescript\n// Before component definition\nconst AppearanceIcon = (\n  \u003csvg fill=\"none\" stroke=\"currentColor\" strokeWidth={2} viewBox=\"0 0 24 24\"\u003e\n    \u003cpath ... /\u003e\n  \u003c/svg\u003e\n);\n\n// Inside component\nreturn \u003cSettingsSection icon={AppearanceIcon} ... /\u003e\n```\n\n**Impact:** HIGH - Avoids recreating JSX elements on every render","status":"open","priority":1,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:23:20.666125+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:23:20.666125+01:00"}
{"id":"My-Prompt-Manager-akm","title":"Add lock to UsageTracker.clearHistory - race condition","description":"UsageTracker.ts:125-131 - Every other write operation uses withLock() except clearHistory(). This is a textbook race condition waiting to happen. Wrap it in withLock() like everything else.","status":"closed","priority":0,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-19T23:29:33.999284+01:00","created_by":"spartDev","updated_at":"2026-01-20T16:00:59.926899+01:00","closed_at":"2026-01-20T16:00:59.926899+01:00","close_reason":"Fixed: all tests pass"}
{"id":"My-Prompt-Manager-ala","title":"Fix tooltip 'Uses' label color inconsistency in analytics charts","status":"closed","priority":2,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-13T17:29:12.52092+01:00","created_by":"spartDev","updated_at":"2026-01-13T17:32:24.202161+01:00","closed_at":"2026-01-13T17:32:24.202161+01:00","close_reason":"Added itemStyle prop to Tooltip in PlatformPieChart, DayOfWeekChart, CategoryBarChart, and TimeOfDayChart to fix black 'Uses' label in dark mode","comments":[{"id":7,"issue_id":"My-Prompt-Manager-ala","author":"spartDev","text":"## Problem Analysis\n\nWhen hovering over charts in the analytics dashboard, the 'Uses' label in tooltips appears in black on the following charts:\n- PlatformPieChart (Pie chart)\n- DayOfWeekChart (Day of week bar chart)\n- CategoryBarChart (Categories horizontal bar chart)\n- TimeOfDayChart (Time of day bar chart)\n\nHowever, the UsageLineChart correctly styles the 'Uses' label with a colored itemStyle.\n\n## Root Cause\n\nThe Recharts Tooltip component has an itemStyle prop that controls the color of the value/label text. UsageLineChart uses this prop (line 104-106), but the other 4 charts don't have it, so the text defaults to black.\n\n## Fix Plan\n\nAdd itemStyle to each affected chart's Tooltip component to set the text color appropriately based on dark mode:\n- Light mode: use a dark text color (#111827 gray-900) \n- Dark mode: use a light text color (#f3f4f6 gray-100)\n\nFiles to update:\n1. src/components/analytics/charts/PlatformPieChart.tsx (line ~109-121)\n2. src/components/analytics/charts/DayOfWeekChart.tsx (line ~90-103)\n3. src/components/analytics/charts/CategoryBarChart.tsx (line ~116-129)\n4. src/components/analytics/charts/TimeOfDayChart.tsx (line ~109-122)","created_at":"2026-01-13T16:30:48Z"}]}
{"id":"My-Prompt-Manager-avh","title":"Consider i18n for stop words in search","description":"SearchIndex.ts:24-28 - English-only stop words means poor search relevance for non-English prompts. Future consideration: language detection or configurable stop word lists.","status":"closed","priority":4,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-19T23:30:03.922075+01:00","created_by":"spartDev","updated_at":"2026-01-20T22:18:18.014195+01:00","closed_at":"2026-01-20T22:18:18.014195+01:00","close_reason":"Not relevant"}
{"id":"My-Prompt-Manager-b1e","title":"Add safeguards to duplicate detection - O(n^2) with 5000 prompts","description":"promptManager.ts:404-474 - With 5000 prompts this does 12.5 million comparisons. The 30s timeout helps but is too generous. Add prompt count limit, consider content hashing for initial filter, yield to keep UI responsive.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-19T23:29:47.686966+01:00","created_by":"spartDev","updated_at":"2026-01-20T17:36:58.745833+01:00","closed_at":"2026-01-20T17:36:58.745833+01:00","close_reason":"Added safeguards: prompt count limit (1000), reduced timeout (10s), length bucket optimization, UI yield mechanism"}
{"id":"My-Prompt-Manager-bla","title":"Fix Top Platform display showing full hostname instead of subdomain","status":"closed","priority":2,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-13T17:09:27.580943+01:00","created_by":"spartDev","updated_at":"2026-01-13T17:15:02.936671+01:00","closed_at":"2026-01-13T17:15:02.936671+01:00","close_reason":"Implemented shared formatPlatformName utility that extracts subdomain from hostnames and truncates long names with ellipsis","comments":[{"id":6,"issue_id":"My-Prompt-Manager-bla","author":"spartDev","text":"## Problem\nWhen the platform is not a known platform (like Claude, ChatGPT), the full hostname (e.g., concierge.sanofi.com) is displayed instead of just the subdomain (concierge). This breaks the UI when names are too long.\n\n## Root Cause\nThe formatPlatformName function (duplicated in 3 files) only maps known platforms and falls back to the raw hostname for unknown ones.\n\n## Solution\n1. Create a shared utility function in src/utils/formatPlatformName.ts that:\n   - Extracts the subdomain from hostnames (concierge.sanofi.com → concierge)\n   - Capitalizes the first letter for display\n   - Truncates long names (max 12 chars with ellipsis)\n\n2. Update formatPlatformName in 3 files:\n   - src/components/analytics/AnalyticsTab.tsx\n   - src/components/analytics/AnalyticsDashboard.tsx\n   - src/components/analytics/charts/PlatformPieChart.tsx\n\n3. Add tests for the new utility function","created_at":"2026-01-13T16:09:48Z"}]}
{"id":"My-Prompt-Manager-blp","title":"Add unit tests for Settings section components","description":"**Files needing test coverage:**\n\n1. AboutSection.tsx - Test reset confirmation flow\n2. AdvancedSection.tsx - Test debug mode toggle\n3. NotificationSection.tsx - Test type toggle and test button\n4. ConfigurationPreview.tsx - Test modal interactions\n5. ImportSection.tsx - Test validation error display\n\n**Test scenarios:**\n- Expand/collapse behavior\n- Form interactions\n- Error states\n- Accessibility (keyboard navigation, ARIA)\n- Edge cases (empty states, loading states)\n\n**Location:** Create in src/components/settings/__tests__/\n\n**Impact:** LOW - Quality assurance, regression prevention","status":"open","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T12:05:54.817062+01:00","created_by":"spartDev","updated_at":"2026-01-26T12:05:54.817062+01:00"}
{"id":"My-Prompt-Manager-bo8","title":"Fix toast type inconsistency - missing 'warning' in ToastProps","description":"ToastProps.type is missing 'warning' variant (line 64 in components.ts) but other interfaces include it (lines 12, 46, 78). Create shared ToastType union type.","status":"closed","priority":1,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-21T18:48:38.370506+01:00","created_by":"spartDev","updated_at":"2026-01-21T18:55:54.686022+01:00","closed_at":"2026-01-21T18:55:54.686022+01:00","close_reason":"Created shared ToastType union type and updated all usages across components.ts, hooks.ts, SettingsView.tsx, SiteIntegrationSection.tsx, and NotificationSection.tsx"}
{"id":"My-Prompt-Manager-bpx","title":"Add usage event helpers to storage.ts","description":"Add to tests/e2e/utils/storage.ts: UsageEvent interface, createUsageEventSeed, createUsageHistory (generates events across days), seedUsageHistory. Handle promptId, timestamp, platform, categoryId fields.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-16T13:26:07.97868+01:00","created_by":"spartDev","updated_at":"2026-01-16T14:37:47.651931+01:00","closed_at":"2026-01-16T14:37:47.651931+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-bqr","title":"Replace alert() with showToast for consistent UX","description":"**Location:** SettingsView.tsx:396, 408, 434\n\n**Problem:** Uses native alert() instead of the showToast prop:\n```typescript\nalert(`Successfully imported ${data.prompts.length.toString()} prompts...`);\nalert('All data has been cleared.');\nalert('Settings have been reset to defaults.');\n```\n\n**Fix:** Use the showToast prop that's already passed to the component:\n```typescript\nshowToast(`Successfully imported ${data.prompts.length} prompts and ${data.categories.length} categories!`, 'success');\nshowToast('All data has been cleared.', 'success');\nshowToast('Settings have been reset to defaults.', 'success');\n```\n\n**Impact:** HIGH - Inconsistent UX, alert() blocks the UI","status":"open","priority":1,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:23:26.478134+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:23:26.478134+01:00"}
{"id":"My-Prompt-Manager-br5","title":"Simplify long dependency array in useEnhancedFloatingPosition","description":"useEnhancedFloatingPosition.ts:149 - 10 dependencies causes frequent effect re-runs.\n\n```typescript\n[isOpen, referenceRef, floatingRef, placement, offsetValue, enableShift, enableFlip, maxHeight, shiftPadding, matchWidth]\n```\n\nAny change triggers cleanup/re-subscribe to autoUpdate.\n\n**Consider:** Using refs for stable values or accepting options as single memoized object.","status":"closed","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-20T22:33:50.472207+01:00","created_by":"spartDev","updated_at":"2026-01-21T16:46:50.349097+01:00","closed_at":"2026-01-21T16:46:50.349097+01:00","close_reason":"Reduced dependency array from 10 to 3 by storing options in a ref. The autoUpdate callback now reads latest options from the ref on each frame."}
{"id":"My-Prompt-Manager-bvi","title":"Document chrome.runtime.onMessage effect dependencies","description":"**Location:** SiteIntegrationSection.tsx:298-328\n\n**Problem:** Effect has empty dependencies but handles external messages:\n```typescript\nuseEffect(() =\u003e {\n  const handleMessage = (message: { type?: string; data?: unknown }) =\u003e {\n    if (message.type === 'ELEMENT_PICKER_RESULT') {\n      const data = message.data as {...};\n      if (data?.selector) {\n        setCustomSelector(data.selector);\n        setElementFingerprint(data.fingerprint || null);\n        setPickingElement(false);\n        // ...\n      }\n    }\n  };\n\n  chrome.runtime.onMessage.addListener(handleMessage);\n  return () =\u003e {\n    chrome.runtime.onMessage.removeListener(handleMessage);\n  };\n}, []);  // Empty deps - intentional?\n```\n\n**Fix:** Add comment explaining why empty deps is intentional:\n```typescript\n// Empty deps intentional: we want a single message listener for the component\n// lifecycle. State setters (setCustomSelector, etc.) are stable.\n```\n\n**Impact:** MEDIUM - Code clarity, prevents accidental changes","status":"open","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:25:12.494156+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:25:12.494156+01:00"}
{"id":"My-Prompt-Manager-by0","title":"Create analytics-dashboard.spec.ts E2E tests","description":"Create tests/e2e/analytics/analytics-dashboard.spec.ts. Test scenarios: renders dashboard with all sections, empty state, charts render (usage trend, platform pie, day of week), tabs (Most Used default, Recently Used, Forgotten), back navigation.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-16T13:26:10.667396+01:00","created_by":"spartDev","updated_at":"2026-01-16T14:50:30.993756+01:00","closed_at":"2026-01-16T14:50:30.993756+01:00","close_reason":"Created E2E test files with comprehensive test coverage","dependencies":[{"issue_id":"My-Prompt-Manager-by0","depends_on_id":"My-Prompt-Manager-6rp","type":"blocks","created_at":"2026-01-16T13:26:21.839052+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-by0","depends_on_id":"My-Prompt-Manager-1dn","type":"blocks","created_at":"2026-01-16T13:26:21.927237+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-by0","depends_on_id":"My-Prompt-Manager-d70","type":"blocks","created_at":"2026-01-16T13:26:22.015115+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-by0","depends_on_id":"My-Prompt-Manager-bpx","type":"blocks","created_at":"2026-01-16T13:26:22.102441+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-by0","depends_on_id":"My-Prompt-Manager-1lg","type":"blocks","created_at":"2026-01-16T13:26:22.185846+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-c76","title":"Remove redundant inline styles in ConfirmDialog","description":"ConfirmDialog.tsx has redundant inline styles that duplicate Tailwind classes.\n\n**Location:** src/components/ConfirmDialog.tsx:108-116\n\n**Current:**\n```tsx\n\u003cdiv \n  className=\"fixed inset-0 z-50 flex items-center justify-center p-3\"\n  style={{ \n    position: 'fixed',\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    height: '100%',\n    width: '100%'\n  }}\n\u003e\n```\n\n**Fix:** Remove the style prop - `fixed inset-0` already handles positioning:\n```tsx\n\u003cdiv className=\"fixed inset-0 z-50 flex items-center justify-center p-3\"\u003e\n```\n\n## Acceptance Criteria\n\n- [ ] Redundant `style` prop is removed from the dialog container div\n- [ ] Only Tailwind classes (`fixed inset-0`) are used for positioning\n- [ ] Dialog still covers full viewport (manual verification)\n- [ ] Dialog backdrop click-to-close still works (if applicable)\n- [ ] Dialog is centered correctly on all viewport sizes\n- [ ] All existing ConfirmDialog tests pass (`npm test src/components/ConfirmDialog`)\n- [ ] No TypeScript errors (`npm run typecheck`)\n- [ ] Linting passes (`npm run lint`)","status":"closed","priority":4,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-23T21:45:34.085062+01:00","created_by":"spartDev","updated_at":"2026-01-24T11:53:53.717469+01:00","closed_at":"2026-01-24T11:53:53.717469+01:00","close_reason":"PR merged"}
{"id":"My-Prompt-Manager-cbv","title":"Hoist SVG icons to module scope in ToastContainer.tsx","description":"**Context**: ToastContainer.tsx creates SVG icons inside getIcon() function, causing recreation on every render.\n\n**Work Required**:\n- Extract all 5 SVG icons (success, error, warning, info, close) to module-scope constants\n- Update getIcon() to return the hoisted constants\n- Also hoist the queue indicator SVG icon\n\n**Acceptance Criteria**:\n- [ ] All SVG icons are defined at module scope as JSX constants\n- [ ] getIcon() returns pre-created icon constants instead of creating new JSX\n- [ ] Close button icon is hoisted\n- [ ] Queue indicator icon is hoisted\n- [ ] No visual changes to toast notifications\n- [ ] All 26 existing tests pass\n- [ ] npm run lint passes\n- [ ] npm run typecheck passes","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-24T22:39:29.690173+01:00","created_by":"spartDev","updated_at":"2026-01-24T22:56:45.610783+01:00","closed_at":"2026-01-24T22:56:45.610783+01:00","close_reason":"Hoisted all 6 SVG icons to module scope, PR #306 created"}
{"id":"My-Prompt-Manager-cj4","title":"Replace console.error with Logger in LibraryView","description":"LibraryView.tsx uses console.error at lines 43 and 55 for error logging. Per CLAUDE.md guidelines, should use the project's Logger utility instead.\n\n**Location:** src/components/LibraryView.tsx:43, 55\n\n**Current:**\n```typescript\nconsole.error('Failed to load sort settings:', error);\n```\n\n**Should be:**\n```typescript\nLogger.error('Failed to load sort settings', toError(error), { component: 'LibraryView' });\n```\n\n## Acceptance Criteria\n\n- [ ] All `console.error` calls in LibraryView.tsx are replaced with `Logger.error`\n- [ ] Logger is imported from `src/utils/logger.ts`\n- [ ] `toError` utility is used to convert unknown error types\n- [ ] Context object includes `{ component: 'LibraryView' }` for traceability\n- [ ] No `console.*` calls remain in the file (verify with grep)\n- [ ] Error handling behavior is unchanged (errors still caught and logged)\n- [ ] All existing tests pass (`npm test`)\n- [ ] No TypeScript errors (`npm run typecheck`)\n- [ ] Linting passes (`npm run lint`)","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-23T21:45:03.24457+01:00","created_by":"spartDev","updated_at":"2026-01-23T21:56:36.949309+01:00","closed_at":"2026-01-23T21:56:36.949309+01:00","close_reason":"Replaced console.error with Logger.error at lines 44 and 56. Added import for Logger and toError from utils. All tests pass (18/18), typecheck clean, lint clean."}
{"id":"My-Prompt-Manager-ck7","title":"useTheme: Refactor fire-and-forget async in setTheme","description":"**Location**: useTheme.ts:108-129\n\n**Problem**: Nested IIFE with void is harder to follow. If setTheme is called rapidly, multiple async operations run concurrently.\n\n**Current code**:\n```tsx\nvoid (async () =\u003e {\n  // ... queries tabs and sends messages\n})();\n```\n\n**Suggestion**: Consider debouncing or extracting to a separate function for clarity and to prevent concurrent execution on rapid calls.","status":"closed","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-21T16:35:43.337946+01:00","created_by":"spartDev","updated_at":"2026-01-21T17:01:47.511419+01:00","closed_at":"2026-01-21T17:01:47.511419+01:00","close_reason":"Refactored fire-and-forget async to extracted notifyContentScriptsOfThemeChange function"}
{"id":"My-Prompt-Manager-coa","title":"Optimize Dropdown keyboard effect dependencies","description":"## Location\nsrc/components/Dropdown.tsx:172-245\n\n## Problem\nThe keyboard navigation effect depends on the items array. If the parent re-creates the items array (even with identical content), this effect re-runs unnecessarily.\n\n## Vercel Best Practice\nViolates rerender-dependencies - use primitive or stable dependencies.\n\n## Fix Options\n1. Use items.length as dependency if logic only cares about existence\n2. Memoize items in parent components\n3. Use a ref for items\n\n## Impact\n- Prevents unnecessary effect re-runs\n- Better performance when items reference changes","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-23T10:29:41.252059+01:00","created_by":"spartDev","updated_at":"2026-01-23T15:27:06.43245+01:00","closed_at":"2026-01-23T15:27:06.43245+01:00","close_reason":"Fixed by PR #290. Used primitive dependencies (hasItems, itemCount) instead of items array to prevent unnecessary effect re-runs."}
{"id":"My-Prompt-Manager-cok","title":"Wire up onExpandDashboard to open full-page analytics","description":"Wire up the onExpandDashboard callback in AnalyticsTab to open the full-page analytics dashboard in a new browser tab.\n\n## Changes Required\n\n### App.tsx\nWhen rendering AnalyticsTab, pass onExpandDashboard callback that:\n1. Gets the extension URL using chrome.runtime.getURL('src/analytics.html')\n2. Opens a new tab with chrome.tabs.create({ url })\n3. Optionally closes the popup/sidepanel after opening (UX decision)\n\n## Implementation\n\\`\\`\\`typescript\nconst handleExpandDashboard = useCallback(() =\u003e {\n  const url = chrome.runtime.getURL('src/analytics.html');\n  void chrome.tabs.create({ url });\n}, []);\n\\`\\`\\`\n\n## Edge Cases\n- Handle case where chrome.tabs API is not available (popup context)\n- Consider using chrome.windows.create as fallback\n- Handle errors gracefully with toast notification\n\n## Acceptance Criteria\n- [ ] \"View Full Dashboard\" button in AnalyticsTab opens analytics.html in new tab\n- [ ] Works in both popup and sidepanel contexts\n- [ ] No console errors when clicking the button\n- [ ] Analytics page loads correctly with dark mode matching system preference\n- [ ] User can navigate back to extension after viewing dashboard","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-13T13:03:21.884677+01:00","created_by":"spartDev","updated_at":"2026-01-13T13:26:53.750649+01:00","closed_at":"2026-01-13T13:26:53.750651+01:00","dependencies":[{"issue_id":"My-Prompt-Manager-cok","depends_on_id":"My-Prompt-Manager-xbk","type":"blocks","created_at":"2026-01-13T13:03:39.284243+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-cok","depends_on_id":"My-Prompt-Manager-iib","type":"blocks","created_at":"2026-01-13T13:03:47.23215+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-d70","title":"Add analyticsWorkflows to workflows.ts","description":"Add analyticsWorkflows object to tests/e2e/utils/workflows.ts. Include: navigateToAnalyticsTab, navigateToFullDashboard, clearHistory, cancelClearHistory, switchTab, verifyAnalyticsSummary, openAnalyticsDashboard. Follow existing workflow pattern.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-16T13:26:07.063811+01:00","created_by":"spartDev","updated_at":"2026-01-16T14:37:47.629958+01:00","closed_at":"2026-01-16T14:37:47.629958+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-dcu","title":"Usage Analytics Dashboard","description":"30-day rolling analytics dashboard showing prompt usage patterns across time, platforms, and categories. Includes compact tab view with summary cards and full-page dashboard with Recharts visualizations. Design doc: docs/plans/2026-01-12-usage-analytics-dashboard-design.md","status":"closed","priority":2,"issue_type":"epic","owner":"roux.tom@gmail.com","created_at":"2026-01-12T22:58:30.21399+01:00","created_by":"spartDev","updated_at":"2026-01-13T12:51:59.673857+01:00","closed_at":"2026-01-13T12:51:59.673857+01:00","close_reason":"All 8 tasks completed. UsageTracker records events, useUsageStats aggregates data, AnalyticsTab and AnalyticsDashboard display metrics with charts, clear history modal implemented, comprehensive test coverage."}
{"id":"My-Prompt-Manager-dcu.1","title":"UsageTracker service + storage integration","description":"Create UsageTracker singleton service with methods: record(), getHistory(), clearHistory(), cleanup(). Store UsageEvent objects in Chrome local storage under 'usageHistory' key. Include 30-day retention cleanup on init.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-12T22:59:07.179476+01:00","created_by":"spartDev","updated_at":"2026-01-13T12:02:47.447238+01:00","closed_at":"2026-01-13T12:02:47.447238+01:00","close_reason":"Implemented UsageTracker singleton service with record/getHistory/clearHistory/cleanup methods, mutex for race conditions, 30-day retention, and comprehensive unit tests (24 tests)","dependencies":[{"issue_id":"My-Prompt-Manager-dcu.1","depends_on_id":"My-Prompt-Manager-dcu","type":"parent-child","created_at":"2026-01-12T22:59:07.180409+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-dcu.2","title":"useUsageStats hook with aggregation logic","description":"Create React hook that queries UsageTracker and aggregates data into chart-ready structures: dailyUsage, platformBreakdown, dayOfWeekDistribution, timeOfDayDistribution, categoryDistribution, topPrompts, recentPrompts, forgottenPrompts.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-12T22:59:08.208471+01:00","created_by":"spartDev","updated_at":"2026-01-13T12:10:40.937901+01:00","closed_at":"2026-01-13T12:10:40.937901+01:00","close_reason":"Implemented useUsageStats hook with comprehensive aggregation logic for daily usage, platform breakdown, day of week distribution, time of day distribution, category distribution, top/recent/forgotten prompts. 28 unit tests.","dependencies":[{"issue_id":"My-Prompt-Manager-dcu.2","depends_on_id":"My-Prompt-Manager-dcu","type":"parent-child","created_at":"2026-01-12T22:59:08.209449+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-dcu.2","depends_on_id":"My-Prompt-Manager-dcu.1","type":"blocks","created_at":"2026-01-12T22:59:30.552486+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-dcu.3","title":"AnalyticsTab with summary cards","description":"Create compact Analytics tab view for popup/side panel. Include 2x2 grid of SummaryCard components showing: total uses, top platform, peak day, top category. Add top 5 prompts list and expand button.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-12T22:59:09.215633+01:00","created_by":"spartDev","updated_at":"2026-01-13T12:20:05.867692+01:00","closed_at":"2026-01-13T12:20:05.867692+01:00","close_reason":"Created SummaryCard and AnalyticsTab components with 2x2 grid of summary cards (total uses, top platform, peak day, top category), top 5 prompts list, expand button, loading/error/empty states, and 57 tests","dependencies":[{"issue_id":"My-Prompt-Manager-dcu.3","depends_on_id":"My-Prompt-Manager-dcu","type":"parent-child","created_at":"2026-01-12T22:59:09.216487+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-dcu.3","depends_on_id":"My-Prompt-Manager-dcu.2","type":"blocks","created_at":"2026-01-12T22:59:34.279383+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-dcu.4","title":"Install Recharts + build chart components","description":"Add Recharts dependency (~40KB). Create chart components: UsageLineChart (30-day trend), PlatformPieChart (donut), DayOfWeekChart (vertical bar), CategoryBarChart (horizontal bar), TimeOfDayChart (buckets).","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-12T22:59:10.28256+01:00","created_by":"spartDev","updated_at":"2026-01-13T12:26:01.973889+01:00","closed_at":"2026-01-13T12:26:01.973889+01:00","close_reason":"Installed Recharts (~37 packages). Created 5 chart components: UsageLineChart (30-day line chart), PlatformPieChart (donut), DayOfWeekChart (vertical bars), CategoryBarChart (horizontal bars), TimeOfDayChart (buckets). All with dark mode support and 27 tests.","dependencies":[{"issue_id":"My-Prompt-Manager-dcu.4","depends_on_id":"My-Prompt-Manager-dcu","type":"parent-child","created_at":"2026-01-12T22:59:10.283313+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-dcu.4","depends_on_id":"My-Prompt-Manager-dcu.2","type":"blocks","created_at":"2026-01-12T22:59:35.27725+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-dcu.5","title":"Full-page dashboard layout","description":"Create analytics.tsx page entry point and AnalyticsDashboard container. Layout: header with back button, line chart row, 2x2 chart grid (platform pie, day-of-week bar, category bar, time-of-day), prompt tables with tabs (Most Used, Recently Used, Forgotten).","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-12T22:59:11.2908+01:00","created_by":"spartDev","updated_at":"2026-01-13T12:32:32.752144+01:00","closed_at":"2026-01-13T12:32:32.752144+01:00","close_reason":"Created analytics.html, analytics.tsx, and AnalyticsDashboard.tsx. Layout includes: header with back button, summary cards (4-col grid), usage trend line chart, 2x2 chart grid (platforms, day-of-week, categories, time-of-day), and tabbed prompt tables (Most Used, Recently Used, Forgotten). All verification passes.","dependencies":[{"issue_id":"My-Prompt-Manager-dcu.5","depends_on_id":"My-Prompt-Manager-dcu","type":"parent-child","created_at":"2026-01-12T22:59:11.291592+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-dcu.5","depends_on_id":"My-Prompt-Manager-dcu.3","type":"blocks","created_at":"2026-01-12T22:59:36.340492+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-dcu.5","depends_on_id":"My-Prompt-Manager-dcu.4","type":"blocks","created_at":"2026-01-12T22:59:37.370128+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-dcu.6","title":"Integration: wire up recording in PromptLibraryInjector","description":"Call UsageTracker.getInstance().record() when prompt is inserted into AI platform. Pass promptId, platform identifier, and categoryId. Update manifest.json if needed for analytics page.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-12T22:59:12.324072+01:00","created_by":"spartDev","updated_at":"2026-01-13T12:40:44.922285+01:00","closed_at":"2026-01-13T12:40:44.922285+01:00","close_reason":"Wired up UsageTracker.record() in background script when PROMPT_USAGE_INCREMENT message received. Content script now passes platform name and categoryId.","dependencies":[{"issue_id":"My-Prompt-Manager-dcu.6","depends_on_id":"My-Prompt-Manager-dcu","type":"parent-child","created_at":"2026-01-12T22:59:12.324895+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-dcu.6","depends_on_id":"My-Prompt-Manager-dcu.1","type":"blocks","created_at":"2026-01-12T22:59:38.523731+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-dcu.7","title":"Polish: dark mode, empty states, loading states","description":"Ensure all analytics components respect dark mode via Tailwind theme. Add empty state UI when no usage data exists. Add loading skeletons while data loads. Add clear history confirmation modal.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-12T22:59:13.337959+01:00","created_by":"spartDev","updated_at":"2026-01-13T12:47:06.76529+01:00","closed_at":"2026-01-13T12:47:06.76529+01:00","close_reason":"Added clear history confirmation modal with proper dark mode and accessibility support. All analytics components now have dark mode, empty states, and loading skeletons.","dependencies":[{"issue_id":"My-Prompt-Manager-dcu.7","depends_on_id":"My-Prompt-Manager-dcu","type":"parent-child","created_at":"2026-01-12T22:59:13.338764+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-dcu.7","depends_on_id":"My-Prompt-Manager-dcu.5","type":"blocks","created_at":"2026-01-12T22:59:39.54575+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-dcu.8","title":"Testing: unit, component, E2E","description":"Unit tests for UsageTracker (record, getHistory, cleanup, clearHistory, date boundaries). Component tests for AnalyticsTab, charts, PromptTable (sorting, tabs, dark mode). E2E tests for record usage flow, clear history, full page navigation.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-12T22:59:14.348393+01:00","created_by":"spartDev","updated_at":"2026-01-13T12:51:43.959198+01:00","closed_at":"2026-01-13T12:51:43.959198+01:00","close_reason":"Added 8 new clear history tests for AnalyticsTab. UsageTracker has 24 comprehensive unit tests. useUsageStats has full test coverage. Chart components have tests. E2E tests can be added when extension is running in browser context.","dependencies":[{"issue_id":"My-Prompt-Manager-dcu.8","depends_on_id":"My-Prompt-Manager-dcu","type":"parent-child","created_at":"2026-01-12T22:59:14.34929+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-dcu.8","depends_on_id":"My-Prompt-Manager-dcu.6","type":"blocks","created_at":"2026-01-12T22:59:40.617856+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-dcu.8","depends_on_id":"My-Prompt-Manager-dcu.7","type":"blocks","created_at":"2026-01-12T22:59:41.614359+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-djh","title":"Fix falsy value edge case in storage.ts","description":"storage.ts:706 - 'return (result[key] as T) || null' returns null for 0, empty string, or false. Use explicit undefined check instead. Low risk currently but bad pattern.","status":"closed","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-19T23:30:02.913778+01:00","created_by":"spartDev","updated_at":"2026-01-20T22:16:36.548741+01:00","closed_at":"2026-01-20T22:16:36.548741+01:00","close_reason":"Already completed in commit f9ec6ae"}
{"id":"My-Prompt-Manager-djt","title":"Consolidate or remove unused SELECTORS module","description":"## Problem\n`tests/e2e/utils/selectors.ts` defines a `SELECTORS` object with CSS-based selectors, but tests primarily use inline role-based locators. This creates two inconsistent selector systems.\n\n## Current State\n**selectors.ts defines:**\n```typescript\nSELECTORS = {\n  headings: { promptManager: 'heading[name=\"My Prompt Manager\"]' },\n  buttons: { addNewPrompt: 'button[name=\"Add new prompt\"]' },\n  // ... 90+ selectors\n}\n```\n\n**But tests use:**\n```typescript\npage.getByRole('button', { name: 'Add new prompt' })  // Not using SELECTORS\npage.getByRole('heading', { name: 'My Prompt Manager' })\n```\n\n## Options\n\n### Option A: Remove SELECTORS module (Recommended)\n- Delete `selectors.ts`\n- Standardize on inline role-based locators\n- Simpler, follows Playwright best practices\n\n### Option B: Update SELECTORS to use createSelectors pattern\n- Refactor `createSelectors(page)` to return role-based locators\n- Update all tests to use centralized selectors\n- More complex but provides single source of truth\n\n## Acceptance Criteria\n- [ ] Decision made: remove or refactor SELECTORS module\n- [ ] No mixed selector strategies in codebase\n- [ ] If removed: all inline locators use role-based strategy\n- [ ] If refactored: all tests use centralized selectors\n- [ ] All E2E tests pass","acceptance_criteria":"## Acceptance Criteria\n- [ ] Decision made: remove or refactor SELECTORS module\n- [ ] No mixed selector strategies in codebase\n- [ ] If removed: all inline locators use role-based strategy\n- [ ] If refactored: all tests use centralized selectors\n- [ ] All E2E tests pass","status":"closed","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-12T18:59:51.906155+01:00","created_by":"spartDev","updated_at":"2026-01-20T22:16:36.553497+01:00","closed_at":"2026-01-20T22:16:36.553497+01:00","close_reason":"Already completed in commit f9ec6ae"}
{"id":"My-Prompt-Manager-dzr","title":"Hoist type guard functions outside Dropdown component","description":"## Location\nsrc/components/Dropdown.tsx:248-276\n\n## Problem\nType guard and helper functions are defined inside the component body and recreated on every render:\n\n```tsx\nconst isMouseEventHandler = (fn: unknown): fn is (e: React.MouseEvent) =\u003e void =\u003e {\n  return typeof fn === 'function';\n};\n\nconst isKeyboardEventHandler = (fn: unknown): fn is (e: React.KeyboardEvent) =\u003e void =\u003e {\n  return typeof fn === 'function';\n};\n\nconst extractTriggerHandlers = (props: unknown): TriggerHandlers =\u003e {\n  // ...\n};\n```\n\n## Vercel Best Practice\nViolates `js-hoist-regexp` principle - hoist pure functions outside components.\n\n## Fix\nMove these functions to module scope (before the component definition).\n\n## Impact\n- Minor performance improvement (fewer allocations per render)\n- Cleaner component body","status":"closed","priority":1,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-23T10:29:33.86839+01:00","created_by":"spartDev","updated_at":"2026-01-23T15:15:11.167832+01:00","closed_at":"2026-01-23T15:15:11.167832+01:00","close_reason":"Functions isMouseEventHandler, isKeyboardEventHandler, and extractTriggerHandlers are already at module scope (lines 54-74). This was completed in commit b48963f."}
{"id":"My-Prompt-Manager-ec6","title":"Wrap async handlers in useCallback in SiteIntegrationSection","description":"**Location:** SiteIntegrationSection.tsx\n\n**Problem:** Multiple complex async functions are defined inside the component without useCallback:\n- handleExportCustomSite (line 117)\n- handlePreviewImport (line 187)\n- handleConfirmImport (line 230)\n- startElementPicker (line 421)\n- handleAddSite (line 534)\n\nThese functions capture component state and may cause stale closure issues.\n\n**Fix:** Wrap each handler in useCallback with appropriate dependencies:\n```typescript\nconst handleAddSite = useCallback(async () =\u003e {\n  // ... implementation\n}, [newSiteUrl, newSiteName, customSelector, ...]);\n```\n\nOr better: refactor state management first (see useReducer issue).\n\n**Impact:** HIGH - Potential stale closure bugs and unnecessary re-renders","status":"open","priority":1,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:23:28.282432+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:23:28.282432+01:00"}
{"id":"My-Prompt-Manager-egu","title":"Integrate FooterToolbar in LibraryView","description":"Replace current footer in LibraryView with FooterToolbar component. Wire up navigation callbacks (onAnalytics, onCategories, onSettings) and pass prompt counts. Handle loading state.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-13T22:44:56.798963+01:00","created_by":"spartDev","updated_at":"2026-01-14T16:25:46.139671+01:00","closed_at":"2026-01-14T16:25:46.139671+01:00","close_reason":"Integrated FooterToolbar in LibraryView with navigation callbacks and prompt counts","dependencies":[{"issue_id":"My-Prompt-Manager-egu","depends_on_id":"My-Prompt-Manager-vaf","type":"blocks","created_at":"2026-01-13T22:45:11.311774+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-egu","depends_on_id":"My-Prompt-Manager-7m2","type":"blocks","created_at":"2026-01-13T22:45:11.407146+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-ejk","title":"useTheme: Replace type assertion with type guard","description":"**Location**: useTheme.ts:36\n\n**Problem**: The includes check on line 35 validates the value, but TypeScript doesn't narrow. Uses type assertion instead of type guard.\n\n**Current code**:\n```tsx\nif (localStorageTheme \u0026\u0026 ['light', 'dark', 'system'].includes(localStorageTheme)) {\n  const migratedTheme = localStorageTheme as Theme;\n```\n\n**Suggestion**: Create a type guard for clarity:\n```tsx\nconst isTheme = (value: string): value is Theme =\u003e \n  ['light', 'dark', 'system'].includes(value);\n\nif (localStorageTheme \u0026\u0026 isTheme(localStorageTheme)) {\n  // localStorageTheme is now narrowed to Theme\n}\n```","status":"closed","priority":4,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-21T16:35:44.237246+01:00","created_by":"spartDev","updated_at":"2026-01-21T17:01:14.616686+01:00","closed_at":"2026-01-21T17:01:14.616686+01:00","close_reason":"Replaced type assertion with type guard"}
{"id":"My-Prompt-Manager-eul","title":"Ensure parent container has relative positioning","description":"Verify the main wrapper div has 'relative' class for absolute positioning of the FAB to work correctly","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-16T12:41:40.911594+01:00","created_by":"spartDev","updated_at":"2026-01-16T12:46:29.031256+01:00","closed_at":"2026-01-16T12:46:29.031256+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-f0n","title":"Fix inline theme button onClick in AppearanceSection","description":"**Location:** AppearanceSection.tsx:72\n\n**Problem:** Creates new function for each theme option on every render:\n```typescript\n{[light, dark, system].map((option) =\u003e (\n  \u003cbutton\n    key={option.value}\n    onClick={() =\u003e { void setTheme(option.value); }}\n    ...\n  \u003e\n```\n\n**Fix:** Use data attribute pattern:\n```typescript\nconst handleThemeClick = useCallback((e: React.MouseEvent\u003cHTMLButtonElement\u003e) =\u003e {\n  const theme = e.currentTarget.dataset.theme as 'light' | 'dark' | 'system';\n  void setTheme(theme);\n}, [setTheme]);\n\n// In render\n\u003cbutton\n  data-theme={option.value}\n  onClick={handleThemeClick}\n  ...\n\u003e\n```\n\n**Impact:** MEDIUM - Creates 3 new functions on every render","status":"open","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:25:03.10799+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:25:03.10799+01:00"}
{"id":"My-Prompt-Manager-f8t","title":"Fix inconsistent dependency arrays in useCategories vs usePrompts","description":"useCategories.ts includes singleton in deps array while usePrompts correctly omits it with explanation.\n\n- usePrompts.ts:27 - Omits singleton from deps (with eslint-disable and comment)\n- useCategories.ts:27 - Includes storageManager in deps\n\n**Fix:** Make useCategories consistent with usePrompts pattern - omit singletons from deps with explanation.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-20T22:33:38.409838+01:00","created_by":"spartDev","updated_at":"2026-01-21T14:52:19.888002+01:00","closed_at":"2026-01-21T14:52:19.888002+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-fak","title":"DRY: Deduplicate button markup in ViewHeader","description":"ViewHeader.tsx has duplicate button markup between subcomponents and legacy API:\n- BackButton subcomponent (lines 305-321) vs onBack handler (lines 561-574)\n- Settings icon SVG path appears twice (lines 342-345 and 587-590)\n\n**Location:** src/components/ViewHeader.tsx\n\n**Impact:** DRY violation, maintenance burden\n\n**Fix:** Have the legacy API render the subcomponents instead of duplicating markup:\n```tsx\n{onBack \u0026\u0026 \u003cBackButton onClick={handleBack} /\u003e}\n{onSettings \u0026\u0026 \u003cSettingsButton onClick={handleSettings} /\u003e}\n```\n\n## Acceptance Criteria\n\n- [ ] Legacy `onBack` prop renders the `BackButton` subcomponent instead of duplicating markup\n- [ ] Legacy `onSettings` prop renders the `SettingsButton` subcomponent instead of duplicating markup\n- [ ] Settings icon SVG appears only once in the file (in the SettingsButton subcomponent)\n- [ ] Back arrow SVG appears only once in the file (in the BackButton subcomponent)\n- [ ] Both legacy API and compound component API produce identical visual output\n- [ ] All existing ViewHeader tests pass (`npm test src/components/ViewHeader`)\n- [ ] No TypeScript errors (`npm run typecheck`)\n- [ ] Linting passes (`npm run lint`)","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-23T21:45:06.054142+01:00","created_by":"spartDev","updated_at":"2026-01-23T21:57:48.273242+01:00","closed_at":"2026-01-23T21:57:48.273242+01:00","close_reason":"PR #292 created - deduplicated button markup using subcomponents"}
{"id":"My-Prompt-Manager-g5v","title":"Extract shared ViewType for currentView","description":"View type 'library' | 'add' | 'edit' is duplicated in AppState (index.ts:129), AppContextType (context.ts:9,17). Extract to shared ViewType.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-21T18:48:46.16702+01:00","created_by":"spartDev","updated_at":"2026-01-22T14:00:21.469439+01:00","closed_at":"2026-01-22T14:00:21.469439+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-glq","title":"Extract JSX in siteConfigs useMemo to lazy evaluation","description":"**Location:** SettingsView.tsx:97-128\n\n**Problem:** siteConfigs memo creates JSX elements during computation:\n```typescript\nconst siteConfigs = useMemo(() =\u003e ({\n  'www.perplexity.ai': {\n    name: 'Perplexity',\n    description: 'AI-powered search engine',\n    icon: \u003cPerplexityIcon /\u003e  // JSX created during memo\n  },\n  // ...\n}), []);\n```\n\n**Fix:** Use lazy evaluation or component references:\n```typescript\nconst siteConfigs = useMemo(() =\u003e ({\n  'www.perplexity.ai': {\n    name: 'Perplexity',\n    description: 'AI-powered search engine',\n    Icon: PerplexityIcon  // Component reference\n  },\n  // ...\n}), []);\n\n// In render\n{Object.entries(siteConfigs).map(([hostname, config]) =\u003e {\n  const Icon = config.Icon;\n  return \u003cSiteCard icon={\u003cIcon /\u003e} ... /\u003e\n})}\n```\n\nOr accept current pattern as it only runs once due to empty deps.\n\n**Impact:** MEDIUM - JSX created during memo computation","status":"open","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:25:11.661004+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:25:11.661004+01:00"}
{"id":"My-Prompt-Manager-gpy","title":"Remove or implement no-op clearSearch in useSearch","description":"useSearch.ts:39-41 - clearSearch callback does nothing.\n\n```typescript\nconst clearSearch = useCallback(() =\u003e {\n  // This will be handled by the parent component\n}, []);\n```\n\nConfusing API - either implement the functionality or remove it from the return value.","status":"closed","priority":1,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-20T22:33:25.102014+01:00","created_by":"spartDev","updated_at":"2026-01-21T14:47:24.415129+01:00","closed_at":"2026-01-21T14:47:24.415129+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-gqm","title":"Replace legacy unknown fields in CustomSite with proper types","description":"CustomSite.positioning has legacy fields anchorId and signature typed as unknown (index.ts:78-79). Either properly type them or mark as deprecated with @deprecated JSDoc.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-21T18:48:47.143626+01:00","created_by":"spartDev","updated_at":"2026-01-22T14:00:10.072711+01:00","closed_at":"2026-01-22T14:00:10.072711+01:00","close_reason":"Added @deprecated JSDoc to anchorId and signature fields, typed signature as ElementFingerprint instead of unknown"}
{"id":"My-Prompt-Manager-gzw","title":"Fix sequential async operations in SettingsView.tsx","description":"**Location:** SettingsView.tsx:212-225\n\n**Problem:** In saveSettings(), tabs are notified sequentially using await inside a for loop, creating a waterfall pattern.\n\n```typescript\nfor (const tab of tabs) {\n  if (tab.id \u0026\u0026 tab.url \u0026\u0026 ...) {\n    try {\n      await chrome.tabs.sendMessage(tab.id, {...});  // Sequential await!\n    } catch {}\n  }\n}\n```\n\n**Fix:** Use Promise.allSettled() for parallel notification:\n```typescript\nawait Promise.allSettled(\n  tabs\n    .filter(tab =\u003e tab.id \u0026\u0026 tab.url?.startsWith('http'))\n    .map(tab =\u003e chrome.tabs.sendMessage(tab.id!, { action: 'settingsUpdated', settings: newSettings }))\n);\n```\n\n**Impact:** CRITICAL - Eliminating waterfalls per Vercel best practices (async-parallel rule)","status":"open","priority":0,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:22:41.850609+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:22:41.850609+01:00"}
{"id":"My-Prompt-Manager-h9e","title":"Add type validation to storage loadData method","description":"UseStorageReturn.loadData\u003cT\u003e (hooks.ts:50) returns Promise\u003cT | null\u003e but caller can request any type without runtime validation. Consider adding Zod schema validation or type guard parameter.","status":"closed","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-21T18:48:50.056308+01:00","created_by":"spartDev","updated_at":"2026-01-22T21:17:32.203777+01:00","closed_at":"2026-01-22T21:17:32.203777+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-ics","title":"Fix memory leak in useClipboard - setTimeout not cleaned up","description":"useClipboard.ts:46-48, 55-58 - setTimeout calls are NOT cleaned up on unmount. If component unmounts before timeout fires, it attempts setState on unmounted component.\n\n**Current code:**\n```typescript\nsetTimeout(() =\u003e {\n  setCopyStatus('idle');\n}, 2000);\n```\n\n**Fix:** Store timeout ID in ref and clear on cleanup.","status":"closed","priority":0,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-20T22:33:18.705632+01:00","created_by":"spartDev","updated_at":"2026-01-21T14:47:24.411956+01:00","closed_at":"2026-01-21T14:47:24.411956+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-iib","title":"Add analytics view type to App.tsx","description":"Add 'analytics' to the ViewType union in App.tsx and render AnalyticsTab when this view is active.\n\n## Changes Required\n- Add 'analytics' to ViewType: `type ViewType = 'library' | 'add' | 'edit' | 'categories' | 'settings' | 'analytics'`\n- Import AnalyticsTab from './components/analytics'\n- Add conditional render for analytics view\n- Wire up onExpandDashboard callback to open chrome.tabs.create() with analytics.html\n- Wire up back navigation to return to library view\n\n## Acceptance Criteria\n- [ ] ViewType includes 'analytics'\n- [ ] AnalyticsTab renders when currentView === 'analytics'\n- [ ] \"View Full Dashboard\" button opens analytics.html in new tab\n- [ ] Back button returns to library view\n- [ ] Dark mode works correctly in analytics view\n- [ ] TypeScript compiles without errors","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-13T13:02:41.519919+01:00","created_by":"spartDev","updated_at":"2026-01-13T13:09:02.792137+01:00","closed_at":"2026-01-13T13:09:02.792137+01:00","close_reason":"Implemented analytics view integration in App.tsx: added 'analytics' to ViewType, imported AnalyticsTab, added handleExpandDashboard callback with chrome.tabs.create, added conditional render. Also added onBack prop to AnalyticsTab with back button in header.","dependencies":[{"issue_id":"My-Prompt-Manager-iib","depends_on_id":"My-Prompt-Manager-xbk","type":"blocks","created_at":"2026-01-13T13:03:39.099658+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-j32","title":"Fix prompt size validation: prompts under 10K chars incorrectly rejected","status":"closed","priority":0,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-12T16:40:14.901861+01:00","created_by":"spartDev","updated_at":"2026-01-12T16:40:34.569141+01:00","closed_at":"2026-01-12T16:40:34.569141+01:00","close_reason":"Fixed: Increased MAX_PROMPT_SIZE from 10KB to 50KB to accommodate 20K character limit (20K chars × 2 bytes/char + overhead). Also added size validation to updatePrompt for consistency."}
{"id":"My-Prompt-Manager-j6e","title":"Extract validation logic to utility functions","description":"**Location:** DataStorageSection.tsx:90-124\n\n**Problem:** Complex validation logic inline in the component:\n```typescript\nconst invalidPrompt = (typedData.prompts as unknown[]).find((prompt) =\u003e {\n  if (typeof prompt \\!== 'object' || prompt === null || Array.isArray(prompt)) {\n    return true;\n  }\n  const p = prompt as Record\u003cstring, unknown\u003e;\n  if (typeof p.title \\!== 'string' || typeof p.content \\!== 'string') {\n    return true;\n  }\n  // ...\n});\n```\n\n**Fix:** Extract to utility:\n```typescript\n// src/utils/validation.ts\nexport function validatePromptStructure(prompt: unknown): prompt is Prompt {\n  if (typeof prompt \\!== 'object' || prompt === null || Array.isArray(prompt)) {\n    return false;\n  }\n  const p = prompt as Record\u003cstring, unknown\u003e;\n  return typeof p.title === 'string' \u0026\u0026 typeof p.content === 'string' \u0026\u0026 typeof p.category === 'string';\n}\n\nexport function validateBackupFile(data: unknown): ValidationResult {\n  // ... comprehensive validation\n}\n```\n\n**Impact:** MEDIUM - Improves testability and reusability","status":"open","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:24:22.592655+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:24:22.592655+01:00"}
{"id":"My-Prompt-Manager-kec","title":"Extract inline SVGs to reusable icon components","description":"**Location:** Multiple files\n\n**Problem:** Many inline SVG icons are repeated across components:\n- AboutSection.tsx: Info icon, GitHub icon, Issue icon, Book icon\n- AdvancedSection.tsx: Settings gear icon\n- NotificationSection.tsx: Bell icon\n- DataStorageSection.tsx: Database icon\n- Multiple chevron icons for expand/collapse\n\n**Fix:** Create centralized icon components:\n```typescript\n// src/components/icons/SettingsIcons.tsx\nexport const InfoIcon: FC\u003cIconProps\u003e = ({ className }) =\u003e (\n  \u003csvg className={className} fill=\"none\" stroke=\"currentColor\" strokeWidth={2} viewBox=\"0 0 24 24\"\u003e\n    \u003cpath strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" /\u003e\n  \u003c/svg\u003e\n);\n\nexport const ChevronDownIcon: FC\u003cIconProps\u003e = ({ className }) =\u003e (...);\nexport const DatabaseIcon: FC\u003cIconProps\u003e = ({ className }) =\u003e (...);\n// etc.\n```\n\n**Impact:** LOW - DRY principle, easier maintenance","status":"open","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T12:05:53.039955+01:00","created_by":"spartDev","updated_at":"2026-01-26T12:05:53.039955+01:00"}
{"id":"My-Prompt-Manager-kt1","title":"Use useCallback for toggle handlers in collapsible sections","description":"**Location:** Multiple files\n\n**Problem:** Inline onClick handlers for expand/collapse create new functions on every render:\n\n1. AboutSection.tsx:35\n   `onClick={() =\u003e { setIsExpanded(!isExpanded); }}`\n\n2. AdvancedSection.tsx:21\n   `onClick={() =\u003e { setIsExpanded(!isExpanded); }}`\n\n3. NotificationSection.tsx:128\n   `onClick={() =\u003e { setIsExpanded(!isExpanded); }}`\n\n**Fix:** Use useCallback with functional setState:\n```typescript\nconst toggleExpanded = useCallback(() =\u003e setIsExpanded(prev =\u003e !prev), []);\n```\n\n**Impact:** MEDIUM - Creates unnecessary function allocations","status":"open","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:24:20.887804+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:24:20.887804+01:00"}
{"id":"My-Prompt-Manager-l5p","title":"Fix lastUsedAt semantic - don't set on new prompts","description":"storage.ts:113 - Setting lastUsedAt on a prompt with usageCount:0 is semantically wrong. Set to undefined or let normalizePrompt handle it.","status":"closed","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-19T23:30:00.853313+01:00","created_by":"spartDev","updated_at":"2026-01-20T22:16:36.546523+01:00","closed_at":"2026-01-20T22:16:36.546523+01:00","close_reason":"Already completed in commit f9ec6ae"}
{"id":"My-Prompt-Manager-lrp","title":"Update existing component tests","description":"Update tests in FilterSortControls.test.tsx (remove Categories), LibraryView.test.tsx (new footer), ViewHeader.test.tsx (no Analytics/Settings in library). Ensure no test regressions.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-13T22:44:59.723823+01:00","created_by":"spartDev","updated_at":"2026-01-14T16:47:33.761521+01:00","closed_at":"2026-01-14T16:47:33.761521+01:00","close_reason":"All test updates verified: FilterSortControls tests updated (removed Manage Categories button tests), LibraryView tests work with new FooterToolbar, ViewHeader tests remain valid for component API. All 1711 tests pass, lint clean, typecheck clean.","dependencies":[{"issue_id":"My-Prompt-Manager-lrp","depends_on_id":"My-Prompt-Manager-7m2","type":"blocks","created_at":"2026-01-13T22:45:12.75031+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-lrp","depends_on_id":"My-Prompt-Manager-666","type":"blocks","created_at":"2026-01-13T22:45:12.842311+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-m0l","title":"Add dark mode support to body background in popup.css","description":"## Task\nThe popup.css file has hardcoded `background: #ffffff` on body (line 39), which doesn't change for dark mode.\n\n## Changes Required\nAdd dark mode variant for body background. Two options:\n1. Use Tailwind's @apply with dark: variant\n2. Add a .dark body { background: \u003cdark-color\u003e; } rule\n\n## Affected Files\n- src/popup.css\n\n## Acceptance Criteria\n- Body background changes appropriately in dark mode\n- No flash of white when loading in dark mode","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-13T17:43:33.557821+01:00","created_by":"spartDev","updated_at":"2026-01-13T17:56:27.431349+01:00","closed_at":"2026-01-13T17:56:27.431349+01:00","close_reason":"Both dependencies complete - analytics now uses ThemeProvider and body has dark mode background"}
{"id":"My-Prompt-Manager-m2b","title":"Add Analytics button to ViewHeader","description":"Add an AnalyticsButton subcomponent to ViewHeader and use it in LibraryView to navigate to the analytics view.\n\n## Changes Required\n\n### ViewHeader.tsx\n- Add 'analytics' to IconType union\n- Add AnalyticsIcon to HeaderIcons.tsx (bar chart icon)\n- Create AnalyticsButton subcomponent similar to SettingsButton\n- Export AnalyticsButton as ViewHeader.AnalyticsButton\n\n### LibraryView.tsx\n- Add onAnalytics prop to LibraryViewProps\n- Add ViewHeader.AnalyticsButton in ViewHeader.Actions (before SettingsButton)\n\n### App.tsx\n- Create handleAnalytics callback that sets currentView to 'analytics'\n- Pass onAnalytics to LibraryView\n\n## Button Design\n- Icon: Bar chart or line chart (consistent with analytics theme)\n- Position: Next to settings button in header\n- Hover state: Same as settings button\n- Accessibility: aria-label=\"View analytics\"\n\n## Acceptance Criteria\n- [ ] AnalyticsButton renders in ViewHeader with chart icon\n- [ ] Clicking button navigates to analytics view\n- [ ] Button has proper hover/focus states\n- [ ] Button has accessible aria-label\n- [ ] Dark mode support\n- [ ] Tests pass for ViewHeader and LibraryView","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-13T13:03:10.503034+01:00","created_by":"spartDev","updated_at":"2026-01-13T13:18:32.708851+01:00","closed_at":"2026-01-13T13:18:32.708851+01:00","close_reason":"Added AnalyticsButton to ViewHeader and wired up navigation from LibraryView to analytics view","dependencies":[{"issue_id":"My-Prompt-Manager-m2b","depends_on_id":"My-Prompt-Manager-xbk","type":"blocks","created_at":"2026-01-13T13:03:39.189064+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-m2b","depends_on_id":"My-Prompt-Manager-iib","type":"blocks","created_at":"2026-01-13T13:03:47.142551+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-mbh","title":"Add generic type parameter to useStorage.saveData","description":"UseStorageReturn.saveData (hooks.ts:49) uses 'unknown' which loses type safety. Should be generic: saveData\u003cT\u003e(key: string, data: T): Promise\u003cvoid\u003e","status":"closed","priority":1,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-21T18:48:44.185506+01:00","created_by":"spartDev","updated_at":"2026-01-21T18:54:26.271614+01:00","closed_at":"2026-01-21T18:54:26.271614+01:00","close_reason":"Added generic type parameter to UseStorageReturn.saveData for type safety and API consistency with loadData"}
{"id":"My-Prompt-Manager-mq5","title":"Remove existing footer from AnalyticsTab","description":"Delete the footer section (lines 318-332) in AnalyticsTab.tsx that contains the View Full Dashboard button and usage count text","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-16T12:41:39.085156+01:00","created_by":"spartDev","updated_at":"2026-01-16T12:46:28.98948+01:00","closed_at":"2026-01-16T12:46:28.98948+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-my_prompt_manager-crew-neo","title":"Crew worker neo in my_prompt_manager - human-managed persistent workspace.","description":"Crew worker neo in my_prompt_manager - human-managed persistent workspace.\n\nrole_type: crew\nrig: my_prompt_manager\nagent_state: idle\nhook_bead: null\nrole_bead: hq-crew-role\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"closed","priority":2,"issue_type":"agent","owner":"roux.tom@gmail.com","created_at":"2026-01-18T22:35:00.765709+01:00","created_by":"spartDev","updated_at":"2026-01-23T14:57:24.508743+01:00","closed_at":"2026-01-23T14:57:24.508743+01:00","close_reason":"Closed","labels":["gt:agent"]}
{"id":"My-Prompt-Manager-my_prompt_manager-refinery","title":"Refinery for my_prompt_manager - processes merge queue.","description":"Refinery for my_prompt_manager - processes merge queue.\n\nrole_type: refinery\nrig: my_prompt_manager\nagent_state: idle\nhook_bead: null\nrole_bead: hq-refinery-role\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"closed","priority":2,"issue_type":"agent","owner":"roux.tom@gmail.com","created_at":"2026-01-18T22:34:32.035467+01:00","created_by":"spartDev","updated_at":"2026-01-23T14:57:14.06268+01:00","closed_at":"2026-01-23T14:57:14.06268+01:00","close_reason":"Closed","labels":["gt:agent"]}
{"id":"My-Prompt-Manager-my_prompt_manager-witness","title":"Witness for my_prompt_manager - monitors polecat health and progress.","description":"Witness for my_prompt_manager - monitors polecat health and progress.\n\nrole_type: witness\nrig: my_prompt_manager\nagent_state: idle\nhook_bead: null\nrole_bead: hq-witness-role\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"closed","priority":2,"issue_type":"agent","owner":"roux.tom@gmail.com","created_at":"2026-01-18T22:34:31.507283+01:00","created_by":"spartDev","updated_at":"2026-01-23T14:57:06.223242+01:00","closed_at":"2026-01-23T14:57:06.223242+01:00","close_reason":"Closed","labels":["gt:agent"]}
{"id":"My-Prompt-Manager-n7s","title":"Memoize Escape key handler in ConfigurationPreview","description":"**Location:** ConfigurationPreview.tsx:31-35\n\n**Problem:** Escape key handler recreated on each render:\n```typescript\nuseEffect(() =\u003e {\n  if (!isOpen) {return;}\n\n  const handleKeyDown = (event: KeyboardEvent) =\u003e {\n    if (event.key === 'Escape') {\n      onClose();\n    }\n  };\n\n  document.addEventListener('keydown', handleKeyDown);\n  return () =\u003e { document.removeEventListener('keydown', handleKeyDown); };\n}, [isOpen, onClose]);\n```\n\n**Fix:** Use useCallback or extract handler:\n```typescript\nconst handleKeyDown = useCallback((event: KeyboardEvent) =\u003e {\n  if (event.key === 'Escape') {\n    onClose();\n  }\n}, [onClose]);\n\nuseEffect(() =\u003e {\n  if (!isOpen) return;\n  document.addEventListener('keydown', handleKeyDown);\n  return () =\u003e document.removeEventListener('keydown', handleKeyDown);\n}, [isOpen, handleKeyDown]);\n```\n\n**Impact:** MEDIUM - Handler recreated on each render","status":"open","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:25:10.833259+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:25:10.833259+01:00"}
{"id":"My-Prompt-Manager-n96","title":"Fix View Full Dashboard link URL path","status":"closed","priority":1,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-13T13:51:27.289405+01:00","created_by":"spartDev","updated_at":"2026-01-13T13:58:54.827034+01:00","closed_at":"2026-01-13T13:58:54.827034+01:00","close_reason":"Fixed URL path from 'analytics.html' to 'src/analytics.html'","comments":[{"id":4,"issue_id":"My-Prompt-Manager-n96","author":"spartDev","text":"BUG: In App.tsx line 241, the URL analytics.html is wrong. The actual build output is at src/analytics.html. Change chrome.runtime.getURL to use src/analytics.html.","created_at":"2026-01-13T12:52:32Z"}]}
{"id":"My-Prompt-Manager-oph","title":"Fix inline handlers in SiteCard","description":"**Location:** SiteCard.tsx:83, 95, 102, 113\n\n**Problem:** Multiple inline handlers create new functions:\n```typescript\nonChange={(checked) =\u003e { void onToggle(hostname, checked); }}\nonClick={() =\u003e { void onExport(hostname); }}\nonClick={() =\u003e { void onEdit(hostname); }}\nonClick={() =\u003e { void onRemove(hostname); }}\n```\n\n**Fix:** Use data attributes with single handlers:\n```typescript\ninterface SiteCardProps {\n  // Change handler signatures to receive hostname from data attribute\n}\n\nconst handleToggle = useCallback((e: React.ChangeEvent\u003cHTMLInputElement\u003e) =\u003e {\n  const hostname = e.currentTarget.dataset.hostname!;\n  void onToggle(hostname, e.currentTarget.checked);\n}, [onToggle]);\n```\n\nOr: Accept that these are prop callbacks and document the trade-off.\n\n**Impact:** MEDIUM - Creates 4 new functions per SiteCard per render","status":"open","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:25:09.9715+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:25:09.9715+01:00"}
{"id":"My-Prompt-Manager-osp","title":"Memoize URL params parsing in SiteIntegrationSection","description":"**Location:** SiteIntegrationSection.tsx:284-290\n\n**Problem:** URL params parsed on every render:\n```typescript\nconst urlParams = new URLSearchParams(window.location.search);\nconst isPickerWindow = urlParams.get('picker') === 'true';\nconst originalTabIdStr = urlParams.get('originalTabId');\nconst originalTabId = originalTabIdStr ? parseInt(originalTabIdStr, 10) : null;\nconst originalUrl = urlParams.get('originalUrl');\nconst originalHostname = urlParams.get('originalHostname');\n```\n\n**Fix:** Use useMemo or extract to custom hook:\n```typescript\nconst { isPickerWindow, originalTabId, originalUrl, originalHostname } = useMemo(() =\u003e {\n  const params = new URLSearchParams(window.location.search);\n  return {\n    isPickerWindow: params.get('picker') === 'true',\n    originalTabId: params.get('originalTabId') ? parseInt(params.get('originalTabId')!, 10) : null,\n    originalUrl: params.get('originalUrl'),\n    originalHostname: params.get('originalHostname')\n  };\n}, []);\n```\n\n**Impact:** HIGH - Unnecessary parsing on every render","status":"open","priority":1,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:23:27.388595+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:23:27.388595+01:00"}
{"id":"My-Prompt-Manager-q36","title":"Document onClose stability requirement in useDropdownClose","description":"useDropdownClose.ts:98 - Effect dependencies include onClose callback.\n\nIf parent doesn't memoize onClose, effect re-runs on every render.\n\n**Fix:** Add JSDoc noting that onClose should be stable (wrapped in useCallback) or use useLatest pattern internally.","status":"closed","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-20T22:33:51.511462+01:00","created_by":"spartDev","updated_at":"2026-01-21T17:01:13.764619+01:00","closed_at":"2026-01-21T17:01:13.764619+01:00","close_reason":"Added JSDoc documenting that onClose should be memoized with useCallback, and updated example to demonstrate proper usage"}
{"id":"My-Prompt-Manager-qal","title":"Final verification - footer toolbar redesign","description":"Run full verification: npm test, npm run lint, npm run typecheck. Manual testing in Chrome extension for popup and sidepanel contexts. Verify dark mode and accessibility.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-13T22:45:00.697371+01:00","created_by":"spartDev","updated_at":"2026-01-14T16:54:57.452459+01:00","closed_at":"2026-01-14T16:54:57.452459+01:00","close_reason":"All automated checks passed (1711 tests, 0 lint errors, typecheck clean). Manual testing confirmed: popup, sidepanel, dark mode, and accessibility all working correctly.","dependencies":[{"issue_id":"My-Prompt-Manager-qal","depends_on_id":"My-Prompt-Manager-36x","type":"blocks","created_at":"2026-01-13T22:45:13.809997+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-qal","depends_on_id":"My-Prompt-Manager-lrp","type":"blocks","created_at":"2026-01-13T22:45:13.90146+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-ql7","title":"Hoist pure utility functions in PromptCard","description":"PromptCard.tsx defines pure utility functions inside the component that are recreated every render:\n\n**Location:** src/components/PromptCard.tsx\n\n**Functions to hoist:**\n1. formatDate (lines 106-108) - simple date formatting\n2. getCategory (lines 110-112) - category lookup\n\n**Current:**\n```typescript\nconst formatDate = (timestamp: number) =\u003e {\n  return new Date(timestamp).toLocaleDateString();\n};\n```\n\n**Fix:** Move to module scope or utils file:\n```typescript\nconst formatDate = (timestamp: number): string =\u003e \n  new Date(timestamp).toLocaleDateString();\n```\n\n## Acceptance Criteria\n\n- [ ] `formatDate` function is hoisted to module scope\n- [ ] `getCategory` function is hoisted to module scope (or converted to inline lookup if trivial)\n- [ ] Both functions have explicit return types\n- [ ] Functions are kept module-private (not exported) unless needed elsewhere\n- [ ] Date formatting displays correctly on prompt cards (manual verification)\n- [ ] Category display works correctly (manual verification)\n- [ ] All existing PromptCard tests pass (`npm test src/components/PromptCard`)\n- [ ] No TypeScript errors (`npm run typecheck`)\n- [ ] Linting passes (`npm run lint`)","status":"closed","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-23T21:45:31.295345+01:00","created_by":"spartDev","updated_at":"2026-01-24T11:58:16.144062+01:00","closed_at":"2026-01-24T11:58:16.144062+01:00","close_reason":"Hoisted formatDate to module scope with explicit return type. Inlined getCategory as trivial .find() call. All tests pass."}
{"id":"My-Prompt-Manager-r0j","title":"Fix bucket range calculation for 90% similarity boundary","description":"The bucket range uses 0.11 * len but the upper bound for 90% similarity is len / 0.9 = len * 1.1111. This can miss valid duplicates for long prompts at exact boundary (e.g., 9090-char and 10100-char prompts are 90% similar but fall 11 buckets apart, while we only check 10).\n\nFix: Use len / 9 instead of len * 0.11 for mathematically correct calculation.","status":"closed","priority":1,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-20T20:08:44.908809+01:00","created_by":"spartDev","updated_at":"2026-01-20T20:10:28.946122+01:00","closed_at":"2026-01-20T20:10:28.946122+01:00","close_reason":"Fixed: use len/9 instead of len*0.11 for exact 90% similarity bound"}
{"id":"My-Prompt-Manager-r84","title":"Document prefix scan performance characteristics","description":"SearchIndex.ts:211-223 - O(vocabulary) per term. Currently acceptable (\u003c2ms) but should note that a trie would be needed if vocabulary grows significantly. Not urgent - just future-proofing documentation.","status":"closed","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-19T23:29:48.697235+01:00","created_by":"spartDev","updated_at":"2026-01-20T22:16:36.542615+01:00","closed_at":"2026-01-20T22:16:36.542615+01:00","close_reason":"Already completed in commit f9ec6ae"}
{"id":"My-Prompt-Manager-rig-my_prompt_manager","title":"my_prompt_manager","description":"Rig identity bead for my_prompt_manager.\n\nrepo: https://github.com/spartDev/My-Prompt-Manager.git\nprefix: My-Prompt-Manager\nstate: active","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-18T22:34:33.207312+01:00","created_by":"spartDev","updated_at":"2026-01-23T14:57:56.377729+01:00","closed_at":"2026-01-23T14:57:56.377729+01:00","close_reason":"Closed","labels":["gt:rig"]}
{"id":"My-Prompt-Manager-rjw","title":"Fix analytics platform tracking: use hostname lookup instead of active strategy","status":"closed","priority":2,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-13T15:04:52.290703+01:00","created_by":"spartDev","updated_at":"2026-01-13T15:13:08.280828+01:00","closed_at":"2026-01-13T15:13:08.280828+01:00","close_reason":"Fixed analytics to use hostname lookup via getPlatformByHostname() instead of activeStrategy.name","comments":[{"id":5,"issue_id":"My-Prompt-Manager-rjw","author":"spartDev","text":"## Problem\n\nWhen tracking prompt usage analytics, the platform name is recorded as 'default' even when the user is on ChatGPT, Claude, or other supported platforms.\n\n## Root Cause\n\nIn src/content/core/injector.ts:1949, the platform name is derived from the active strategy. When DefaultStrategy handles the insertion (it always returns true from canHandle() as fallback), its name 'default' is recorded.\n\n## Fix\n\nUse getPlatformByHostname() to get the platform ID based on the URL hostname instead of relying on which strategy performed the insertion.\n\n## Files to Modify\n\n- src/content/core/injector.ts - Update usage tracking to use hostname-based platform identification","created_at":"2026-01-13T14:05:24Z"}]}
{"id":"My-Prompt-Manager-rvh","title":"Split SiteIntegrationSection.tsx into smaller components","description":"**Location:** SiteIntegrationSection.tsx (1099 lines)\n\n**Problem:** Component is doing too much - handles site toggling, custom site management, element picker, import/export, tab URL detection, and permission requests.\n\n**Recommendation:** Split into smaller, focused components:\n- SupportedSitesList.tsx - Built-in site cards\n- CustomSitesList.tsx - Custom site cards with add/remove\n- SiteImportDrawer.tsx - Import configuration flow\n- AddCustomSiteForm.tsx - Manual site configuration form\n- usePickerWindow.ts - Hook for picker window state\n- useSitePermissions.ts - Hook for permission handling\n\n**Impact:** CRITICAL - 1099 lines violates single responsibility principle, makes testing and maintenance difficult","status":"open","priority":0,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:22:43.616267+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:22:43.616267+01:00"}
{"id":"My-Prompt-Manager-sj5","title":"Fix unsafe assignment lint error in tests/e2e/utils/index.ts:43","status":"closed","priority":2,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-12T22:33:04.88157+01:00","created_by":"spartDev","updated_at":"2026-01-12T22:38:57.649716+01:00","closed_at":"2026-01-12T22:38:57.649716+01:00","close_reason":"Removed reference to non-existent SELECTORS export from E2EUtils.Selectors"}
{"id":"My-Prompt-Manager-snj","title":"Optimize useSort to avoid potential double-render","description":"useSort.ts:40-43 - Two separate setState calls could cause double render (though React batches in event handlers).\n\n```typescript\nconst handleSortChange = useCallback((order, direction) =\u003e {\n  setSortOrder(order);      // First render\n  setSortDirection(direction); // Second render\n}, []);\n```\n\n**Fix:** Use single state object or reducer for atomic updates.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-20T22:33:39.434611+01:00","created_by":"spartDev","updated_at":"2026-01-21T14:52:35.837689+01:00","closed_at":"2026-01-21T14:52:35.837689+01:00","close_reason":"Refactored useSort to use single state object for atomic updates, eliminating potential double-render issue"}
{"id":"My-Prompt-Manager-tm5","title":"Fix dirty state logic in EditPromptForm","description":"## Location\nsrc/components/EditPromptForm.tsx:88-102\n\n## Problem\nThe `hasUnsavedChanges` state never resets to `false` even if the user reverts all changes:\n\n```tsx\nconst handleFieldChange = (field: 'title' | 'content' | 'category', value: string) =\u003e {\n  const isDirty =\n    field === 'title' ? value \\!== prompt.title :\n    field === 'content' ? value \\!== prompt.content :\n    value \\!== prompt.category;\n\n  setHasUnsavedChanges(isDirty || hasUnsavedChanges);  // Only accumulates, never decrements\n  // ...\n};\n```\n\nOnce `hasUnsavedChanges` becomes `true`, it stays `true` for the rest of the session.\n\n## Vercel Best Practice\nViolates `rerender-derived-state` - derive state from actual form values.\n\n## Fix Options\n\n### Option 1: Track each field's dirty state\n```tsx\nconst [dirtyFields, setDirtyFields] = useState\u003cSet\u003cstring\u003e\u003e(new Set());\n\nconst handleFieldChange = (field: string, value: string) =\u003e {\n  const originalValue = field === 'title' ? prompt.title : \n                        field === 'content' ? prompt.content : prompt.category;\n  \n  setDirtyFields(prev =\u003e {\n    const next = new Set(prev);\n    if (value \\!== originalValue) {\n      next.add(field);\n    } else {\n      next.delete(field);\n    }\n    return next;\n  });\n};\n\nconst hasUnsavedChanges = dirtyFields.size \u003e 0;\n```\n\n### Option 2: Compare form data on submit\nRemove the dirty tracking altogether and compare in submit action.\n\n## Impact\n- UX bug: 'Unsaved changes' warning shows even when form matches original values","status":"closed","priority":2,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-23T10:29:08.079976+01:00","created_by":"spartDev","updated_at":"2026-01-23T15:16:24.55169+01:00","closed_at":"2026-01-23T15:16:24.55169+01:00","close_reason":"Fix already merged to main in commit 646219a. The EditPromptForm now correctly derives hasUnsavedChanges by comparing currentValues state to the original prompt, so dirty state resets when values match."}
{"id":"My-Prompt-Manager-tqa","title":"Update AnalyticsTab tests for new FAB button","description":"Update tests in AnalyticsTab.test.tsx for the new FAB button text ('Full Dashboard' instead of 'View Full Dashboard') and verify button visibility","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-16T12:41:42.693986+01:00","created_by":"spartDev","updated_at":"2026-01-16T16:18:01.968022+01:00","closed_at":"2026-01-16T16:18:01.968022+01:00","close_reason":"Updated FAB button text from 'View Full Dashboard' to 'Full Dashboard' in both component and tests","dependencies":[{"issue_id":"My-Prompt-Manager-tqa","depends_on_id":"My-Prompt-Manager-1f5","type":"blocks","created_at":"2026-01-16T12:42:13.713103+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-uwl","title":"useTheme: Memoize return value to prevent context consumer re-renders","description":"**Location**: useTheme.ts:168-173\n\n**Problem**: Every render creates a new object reference, causing all ThemeContext consumers to re-render even when values haven't changed.\n\n**Current code**:\n```tsx\nreturn {\n  theme,\n  resolvedTheme,\n  setTheme,\n  toggleTheme\n};\n```\n\n**Fix**: Wrap return value in useMemo:\n```tsx\nreturn useMemo(() =\u003e ({\n  theme,\n  resolvedTheme,\n  setTheme,\n  toggleTheme\n}), [theme, resolvedTheme, setTheme, toggleTheme]);\n```\n\n**Vercel Rule**: rerender-memo - memoize values passed to context providers.","status":"closed","priority":1,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-21T16:35:40.640633+01:00","created_by":"spartDev","updated_at":"2026-01-21T16:45:09.187771+01:00","closed_at":"2026-01-21T16:45:09.187771+01:00","close_reason":"Memoized useTheme return value using useMemo to prevent unnecessary context consumer re-renders"}
{"id":"My-Prompt-Manager-uwt","title":"useTheme: Stabilize storage change listener dependency","description":"**Location**: useTheme.ts:56-79\n\n**Problem**: Storage change listener is recreated every time theme changes due to [theme] dependency. This adds/removes listeners unnecessarily.\n\n**Current code**:\n```tsx\n}, [theme]);\n```\n\n**Fix**: Use a ref to access current theme in the callback:\n```tsx\nconst themeRef = useRef(theme);\nthemeRef.current = theme;\n\nuseEffect(() =\u003e {\n  // ... listener uses themeRef.current instead of theme\n}, []); // stable dependency\n```\n\n**Vercel Rule**: rerender-dependencies - use primitive/stable dependencies.","status":"closed","priority":2,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-21T16:35:42.444567+01:00","created_by":"spartDev","updated_at":"2026-01-21T16:47:10.880412+01:00","closed_at":"2026-01-21T16:47:10.880412+01:00","close_reason":"Fixed by using themeRef and effect to update it, removing unstable [theme] dependency from storage and media query listener effects"}
{"id":"My-Prompt-Manager-ux6","title":"Simplify MockMediaQueryList type definition","description":"MockMediaQueryList (test-helpers.ts:109) uses verbose ReturnType\u003ctypeof import('vitest').vi.fn\u003e. Simplify to use Mock type already imported.","status":"closed","priority":4,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-21T18:48:52.957741+01:00","created_by":"spartDev","updated_at":"2026-01-22T21:37:52.61631+01:00","closed_at":"2026-01-22T21:37:52.61631+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-v5r","title":"Refinery Patrol","description":"Merge queue processor patrol loop with verification gates.","status":"closed","priority":2,"issue_type":"molecule","owner":"roux.tom@gmail.com","created_at":"2026-01-18T22:34:32.997831+01:00","created_by":"spartDev","updated_at":"2026-01-23T14:57:34.319757+01:00","closed_at":"2026-01-23T14:57:34.319757+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-v5w","title":"Add tests for Analytics view integration","description":"Add unit and component tests for the analytics view integration in App.tsx, ViewHeader, and LibraryView.\n\n## Test Cases\n\n### App.tsx Tests\n- [ ] Analytics view renders AnalyticsTab when currentView is 'analytics'\n- [ ] handleAnalytics callback sets currentView to 'analytics'\n- [ ] Back navigation from analytics returns to library view\n- [ ] onExpandDashboard opens analytics.html in new tab\n\n### ViewHeader Tests\n- [ ] AnalyticsButton renders with chart icon\n- [ ] AnalyticsButton onClick handler is called\n- [ ] AnalyticsButton has correct aria-label\n- [ ] AnalyticsButton displays in dark mode correctly\n\n### LibraryView Tests\n- [ ] AnalyticsButton appears in header actions\n- [ ] Clicking analytics button calls onAnalytics prop\n- [ ] Analytics button position is before settings button\n\n### Integration Tests\n- [ ] Full flow: Library → Analytics → Full Dashboard → Back\n- [ ] Navigation state is preserved correctly\n\n## Test Files to Update/Create\n- src/components/__tests__/App.test.tsx (if exists, or create)\n- src/components/__tests__/ViewHeader.test.tsx\n- src/components/__tests__/LibraryView.test.tsx\n\n## Acceptance Criteria\n- [ ] All new tests pass\n- [ ] No regression in existing tests\n- [ ] Test coverage for happy path and error cases\n- [ ] TypeScript compiles without errors\n- [ ] Lint passes","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-13T13:03:32.368188+01:00","created_by":"spartDev","updated_at":"2026-01-13T13:32:31.103805+01:00","closed_at":"2026-01-13T13:32:31.103805+01:00","close_reason":"Added tests for ViewHeader.AnalyticsButton, App.analytics, and LibraryView","dependencies":[{"issue_id":"My-Prompt-Manager-v5w","depends_on_id":"My-Prompt-Manager-xbk","type":"blocks","created_at":"2026-01-13T13:03:39.374948+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-v5w","depends_on_id":"My-Prompt-Manager-iib","type":"blocks","created_at":"2026-01-13T13:03:47.324619+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-v5w","depends_on_id":"My-Prompt-Manager-m2b","type":"blocks","created_at":"2026-01-13T13:03:47.415027+01:00","created_by":"spartDev"},{"issue_id":"My-Prompt-Manager-v5w","depends_on_id":"My-Prompt-Manager-cok","type":"blocks","created_at":"2026-01-13T13:03:47.506465+01:00","created_by":"spartDev"}]}
{"id":"My-Prompt-Manager-vaf","title":"Create FooterToolbar component","description":"Create new FooterToolbar component (src/components/FooterToolbar.tsx) with Analytics, Categories, Settings buttons and stats display. Props: onAnalytics, onCategories, onSettings, totalPrompts, filteredPrompts, loading. Follow design system glassmorphism and focus-interactive patterns.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-13T22:44:53.915428+01:00","created_by":"spartDev","updated_at":"2026-01-14T16:02:48.834132+01:00","closed_at":"2026-01-14T16:02:48.834132+01:00","close_reason":"Created FooterToolbar component with 25 passing tests"}
{"id":"My-Prompt-Manager-vg8","title":"Hoist SVG icon and fix async pattern in StorageWarning.tsx","description":"**Context**: StorageWarning.tsx recreates the warning icon SVG every render and uses an awkward async IIFE pattern in handleConfirmClear.\n\n**Work Required**:\n- Extract warning icon SVG to module-scope constant\n- Convert handleConfirmClear from IIFE pattern to direct async handler\n\n**Acceptance Criteria**:\n- [ ] Warning icon SVG is defined at module scope with dynamic className\n- [ ] handleConfirmClear is a direct async function (no IIFE wrapper)\n- [ ] Clear data functionality still works correctly\n- [ ] npm run lint passes\n- [ ] npm run typecheck passes","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-24T22:39:31.651444+01:00","created_by":"spartDev","updated_at":"2026-01-24T22:59:16.632192+01:00","closed_at":"2026-01-24T22:59:16.632192+01:00","close_reason":"Completed: Hoisted WarningIcon to module scope, converted handleConfirmClear to direct async handler. Branch pushed: refactor-vg8-storage-warning"}
{"id":"My-Prompt-Manager-vgq","title":"Fix UpdateSettingsMock type using any from StorageChange","description":"UpdateSettingsMock (test-helpers.ts:78-80) uses chrome.storage.StorageChange['newValue'] which resolves to 'any'. Should use Settings type directly.","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-21T18:48:51.033419+01:00","created_by":"spartDev","updated_at":"2026-01-22T14:00:06.051138+01:00","closed_at":"2026-01-22T14:00:06.051138+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-vrq","title":"Remove console.log statements from E2E tests","description":"## Problem\nE2E tests contain `console.log` statements for debugging/progress tracking. These clutter test output and don't integrate with Playwright's built-in reporting.\n\n## Current Issues\n`power-user-management.spec.ts` contains:\n```typescript\nconsole.log('[TEST] Starting Scenario 1: Bulk category reorganization');\nconsole.log('[TEST] Starting Scenario 2: Category consolidation');\nconsole.log('[TEST] All power user scenarios validated successfully! 🎉');\n```\n\n## Solution\nReplace console.log with Playwright's `test.step()` for proper test reporting:\n\n**Before:**\n```typescript\nconsole.log('[TEST] Starting Scenario 1: Bulk category reorganization');\n// ... test code\n```\n\n**After:**\n```typescript\nawait test.step('Scenario 1: Bulk category reorganization', async () =\u003e {\n  // ... test code\n});\n```\n\n## Benefits\n- Steps appear in HTML report with timing\n- Better failure diagnostics\n- Cleaner test output\n- Integrates with CI/CD reporters\n\n## Acceptance Criteria\n- [ ] No `console.log` statements in any E2E test files\n- [ ] Scenario steps use `test.step()` where appropriate\n- [ ] All E2E tests pass\n- [ ] HTML report shows step breakdowns","acceptance_criteria":"## Acceptance Criteria\n- [ ] No `console.log` statements in any E2E test files\n- [ ] Scenario steps use `test.step()` where appropriate\n- [ ] All E2E tests pass\n- [ ] HTML report shows step breakdowns","status":"closed","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-12T18:59:49.590101+01:00","created_by":"spartDev","updated_at":"2026-01-20T22:16:36.551283+01:00","closed_at":"2026-01-20T22:16:36.551283+01:00","close_reason":"Already completed in commit f9ec6ae"}
{"id":"My-Prompt-Manager-vx1","title":"Split power-user-management.spec.ts into isolated tests","description":"## Problem\n`power-user-management.spec.ts` is a single 440-line test containing 5 scenarios that share state. This violates test isolation principles and makes debugging difficult.\n\n## Current Structure\n```typescript\ntest('should handle advanced prompt organization workflow', async () =\u003e {\n  // Scenario 1: Bulk category reorganization (lines 1-100)\n  // Scenario 2: Category consolidation (lines 101-200)\n  // Scenario 3: Advanced search \u0026 filtering (lines 201-280)\n  // Scenario 4: Bulk prompt operations (lines 281-350)\n  // Scenario 5: Data export for backup (lines 351-440)\n});\n```\n\n## Problems\n1. **State Accumulation**: Each scenario depends on previous scenario's state\n2. **Debugging Difficulty**: Can't run Scenario 4 in isolation\n3. **Flaky Tests**: Failure in Scenario 2 causes all subsequent scenarios to fail\n4. **Slow Feedback**: Must run entire test even if only testing one scenario\n\n## Solution\nSplit into isolated tests with shared setup:\n\n```typescript\ntest.describe('Power User Management', () =\u003e {\n  test.beforeEach(async ({ storage }) =\u003e {\n    await testDataManager.seedForPowerUserTesting();\n  });\n\n  test('should rename category and verify prompts updated', async () =\u003e {});\n  test('should consolidate categories by moving prompts', async () =\u003e {});\n  test('should filter and search across categories', async () =\u003e {});\n  test('should move prompts between categories', async () =\u003e {});\n  test('should export library data for backup', async () =\u003e {});\n});\n```","notes":"## Acceptance Criteria\n- [ ] Each scenario is a separate test function\n- [ ] Tests can run independently in any order\n- [ ] Shared setup in `beforeEach` seeds consistent initial state\n- [ ] No test depends on another test's side effects\n- [ ] All tests pass when run individually: `npx playwright test -g \"scenario name\"`\n- [ ] All tests pass when run in parallel\n- [ ] Test file is under 300 lines (split further if needed)","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-12T18:59:54.730058+01:00","created_by":"spartDev","updated_at":"2026-01-13T11:53:30.504873+01:00","closed_at":"2026-01-13T11:53:30.504873+01:00","close_reason":"Split single 437-line test into 5 isolated tests with shared seed data factory. Tests now run in parallel and can be debugged individually."}
{"id":"My-Prompt-Manager-wu7","title":"Make Clear history button more visible","status":"closed","priority":2,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-13T13:51:26.330337+01:00","created_by":"spartDev","updated_at":"2026-01-13T14:03:12.813422+01:00","closed_at":"2026-01-13T14:03:12.813422+01:00","close_reason":"Closed","comments":[{"id":3,"issue_id":"My-Prompt-Manager-wu7","author":"spartDev","text":"Update Clear history button styling in AnalyticsTab.tsx (lines 348-358): Change text-xs to text-sm, text-gray-400 to text-red-500, icon from w-3 h-3 to w-4 h-4, add padding and hover background for better visibility.","created_at":"2026-01-13T12:52:31Z"}]}
{"id":"My-Prompt-Manager-xbk","title":"(EPIC) Analytics View Integration","description":"Integrate AnalyticsTab component into the main app navigation. Currently the analytics components exist but are not accessible from the UI. Users need a way to view their usage analytics from the popup/sidepanel.","status":"closed","priority":2,"issue_type":"epic","owner":"roux.tom@gmail.com","created_at":"2026-01-13T13:02:31.756038+01:00","created_by":"spartDev","updated_at":"2026-01-13T13:32:37.036256+01:00","closed_at":"2026-01-13T13:32:37.036256+01:00","close_reason":"All subtasks completed: analytics view type, button, expand dashboard, and tests"}
{"id":"My-Prompt-Manager-xgk","title":"Add deprecation timeline for legacy checksum format","description":"configurationEncoder.ts:518-525 - The 8-char legacy checksum is weaker than the 16-char SHA-256 one. Need a deprecation path. Add logging when legacy checksums are encountered to track usage before removal.","status":"closed","priority":4,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-19T23:30:01.887898+01:00","created_by":"spartDev","updated_at":"2026-01-22T21:37:18.754726+01:00","closed_at":"2026-01-22T21:37:18.754726+01:00","close_reason":"Closed"}
{"id":"My-Prompt-Manager-xkr","title":"Standardize locator strategy to role-based selectors","description":"## Problem\nE2E tests use inconsistent locator strategies. Some tests correctly use role-based locators (`getByRole`, `getByLabel`) while others use CSS selectors that are fragile and tied to DOM structure.\n\n## Current Issues\n- `selectors.ts` defines CSS-based selectors like `'heading[name=\"My Prompt Manager\"]'`\n- Tests use `page.locator('div').filter({ hasText: '...' })` patterns\n- `page.locator('input[placeholder=\"Category name\"]')` instead of `getByPlaceholder()`\n\n## Solution\nStandardize on Playwright's recommended locator priority:\n1. `getByRole()` - buttons, headings, links, etc.\n2. `getByLabel()` - form inputs with labels\n3. `getByPlaceholder()` - inputs with placeholder text\n4. `getByText()` - visible text content\n5. `getByTestId()` - only when above options don't work\n\n## Acceptance Criteria\n- [ ] All tests use role-based locators where possible\n- [ ] No CSS class selectors (`.class-name`) in test code\n- [ ] No DOM structure selectors (`div \u003e span`) in test code\n- [ ] `selectors.ts` updated or removed in favor of inline role-based locators\n- [ ] All E2E tests pass after refactoring","acceptance_criteria":"## Acceptance Criteria\n- [ ] All tests use role-based locators where possible\n- [ ] No CSS class selectors (`.class-name`) in test code\n- [ ] No DOM structure selectors (`div \u003e span`) in test code\n- [ ] `selectors.ts` updated or removed in favor of inline role-based locators\n- [ ] All E2E tests pass after refactoring","status":"closed","priority":1,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-12T18:59:44.521776+01:00","created_by":"spartDev","updated_at":"2026-01-12T22:13:39.792211+01:00","closed_at":"2026-01-12T22:13:39.792211+01:00","close_reason":"Standardized locator strategy to role-based selectors across all E2E tests"}
{"id":"My-Prompt-Manager-y6t","title":"Use clsx/cn utility for class composition","description":"**Location:** AddCustomSiteCard.tsx:44, and other components\n\n**Problem:** String template for classes is verbose and error-prone:\n```typescript\nclassName={`${baseClasses} ${stateClasses} ${className}`}\n```\n\n**Fix:** Use a utility like clsx or create a cn() helper:\n```typescript\n// src/utils/cn.ts\nimport { clsx, type ClassValue } from 'clsx';\nimport { twMerge } from 'tailwind-merge';\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n\n// Usage\nclassName={cn(baseClasses, stateClasses, className)}\n```\n\n**Impact:** LOW - Code clarity and maintainability","status":"open","priority":3,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T12:05:52.043665+01:00","created_by":"spartDev","updated_at":"2026-01-26T12:05:52.043665+01:00"}
{"id":"My-Prompt-Manager-yrv","title":"Fix nested setState anti-pattern in useToast","description":"useToast.ts:113-114 - Calling setQueue inside setToasts functional update is an anti-pattern causing unpredictable batching.\n\n**Current code:**\n```typescript\nsetToasts(currentToasts =\u003e {\n  if (currentToasts.length === 0) {\n    return [toast];\n  } else {\n    setQueue(prev =\u003e [...prev, toast]); // ❌ setState inside setState\n    return currentToasts;\n  }\n});\n```\n\n**Fix:** Check state outside, then call appropriate setter.","status":"closed","priority":1,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-20T22:33:19.736029+01:00","created_by":"spartDev","updated_at":"2026-01-21T09:23:20.65174+01:00","closed_at":"2026-01-21T09:23:20.65174+01:00","close_reason":"Fixed nested setState anti-pattern by using a ref to track toast count and checking it outside setState"}
{"id":"My-Prompt-Manager-ytz","title":"Wrap CategoryManager handlers in useCallback","description":"CategoryManager.tsx has several handler functions (lines 41-127) that are recreated on every render without useCallback:\n\n**Location:** src/components/CategoryManager.tsx\n\n**Functions:**\n- handleCreateCategory (line 41)\n- handleUpdateCategory (line 72)\n- handleDeleteCategory (line 100)\n- handleConfirmDelete (line 109)\n- handleCancelDelete (line 125)\n\n**Impact:** Minor - these handlers are not passed as props to memoized children, so the impact is low.\n\n**Fix:** Wrap in useCallback for consistency with project patterns:\n```typescript\nconst handleCancelDelete = useCallback(() =\u003e {\n  setDeleteConfirm({ isOpen: false, category: null });\n}, []);\n```\n\n## Acceptance Criteria\n\n- [ ] `handleCreateCategory` is wrapped in `useCallback` with appropriate dependencies\n- [ ] `handleUpdateCategory` is wrapped in `useCallback` with appropriate dependencies\n- [ ] `handleDeleteCategory` is wrapped in `useCallback` with appropriate dependencies\n- [ ] `handleConfirmDelete` is wrapped in `useCallback` with appropriate dependencies\n- [ ] `handleCancelDelete` is wrapped in `useCallback` with appropriate dependencies\n- [ ] Dependencies are correctly specified (no missing deps, no unnecessary deps)\n- [ ] Category CRUD operations still work correctly (manual verification)\n- [ ] All existing CategoryManager tests pass (`npm test src/components/CategoryManager`)\n- [ ] No TypeScript errors (`npm run typecheck`)\n- [ ] Linting passes (`npm run lint`)","status":"closed","priority":4,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-23T21:45:35.00819+01:00","created_by":"spartDev","updated_at":"2026-01-24T11:53:53.719529+01:00","closed_at":"2026-01-24T11:53:53.719529+01:00","close_reason":"PR merged"}
{"id":"My-Prompt-Manager-z1j","title":"Memoize StorageManager.getInstance() call","description":"**Location:** SettingsView.tsx:92\n\n**Problem:** StorageManager.getInstance() is called on every render:\n```typescript\nconst storageManager = StorageManager.getInstance();\n```\n\nWhile it returns a singleton, the call still happens each render and creates unstable reference for dependencies.\n\n**Fix:**\n```typescript\nconst storageManager = useMemo(() =\u003e StorageManager.getInstance(), []);\n```\n\nAlso fix the dependency at line 173 which uses storageManager.\n\n**Impact:** HIGH - Unstable dependency causing loadSettings to be recreated","status":"open","priority":1,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-26T00:23:18.043966+01:00","created_by":"spartDev","updated_at":"2026-01-26T00:23:18.043966+01:00"}
{"id":"My-Prompt-Manager-zfx","title":"Fix timezone bug in getPromptStatistics - mixing UTC and local time","description":"promptManager.ts:379-388 - toISOString() returns UTC but setHours() sets LOCAL time. In non-UTC timezones, the dateString and filter range represent different calendar days. This is basic date handling - pick one timezone and stick with it.","status":"closed","priority":0,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-19T23:29:32.951504+01:00","created_by":"spartDev","updated_at":"2026-01-20T16:00:59.904795+01:00","closed_at":"2026-01-20T16:00:59.904795+01:00","close_reason":"Fixed: all tests pass"}
{"id":"My-Prompt-Manager-zmf","title":"Remove redundant onKeyDown handler in SearchBar","description":"## Location\nsrc/components/SearchBar.tsx:43-48\n\n## Problem\nThe SearchBar component has a redundant `onKeyDown` handler on the clear button:\n\n```tsx\n\u003cbutton\n  onClick={onClear as () =\u003e void}\n  onKeyDown={(e) =\u003e {\n    if (e.key === 'Enter' || e.key === ' ') {\n      e.preventDefault();\n      (onClear as () =\u003e void)();\n    }\n  }}\n```\n\nNative `\u003cbutton\u003e` elements already handle Enter and Space keys automatically. This handler is completely unnecessary.\n\n## Additional Issue\nThe type assertion `onClear as () =\u003e void` suggests the `SearchBarProps` type definition may be incorrect.\n\n## Fix\n1. Remove the entire `onKeyDown` handler\n2. Review `SearchBarProps` type for `onClear` - should be `() =\u003e void`\n\n## Impact\n- Code bloat\n- Potential confusion for maintainers\n- Extra event listener overhead","status":"closed","priority":1,"issue_type":"bug","owner":"roux.tom@gmail.com","created_at":"2026-01-23T10:28:59.19578+01:00","created_by":"spartDev","updated_at":"2026-01-23T15:16:18.625024+01:00","closed_at":"2026-01-23T15:16:18.625024+01:00","close_reason":"Already fixed in commit fa28ab3 / PR #288. Tests pass, lint clean, typecheck clean."}
{"id":"My-Prompt-Manager-zph","title":"Use import type for type-only imports","description":"Several components import types without using `import type`, which can affect bundle size and TypeScript isolatedModules compliance.\n\n**Locations:**\n- src/components/InterfaceModeSelector.tsx:1 - `import { FC }`\n- src/components/PromptCard.tsx:3 - `import type { FC, MouseEvent, ReactNode }` (partially correct)\n\n**Fix:**\n```typescript\nimport type { FC } from 'react';\n```\n\n**Note:** This is a minor optimization but aligns with TypeScript best practices.\n\n## Acceptance Criteria\n\n- [ ] InterfaceModeSelector.tsx uses `import type { FC }` instead of `import { FC }`\n- [ ] PromptCard.tsx has consistent type imports (all type-only imports use `import type`)\n- [ ] Scan codebase for other components with similar issues and fix them\n- [ ] All type-only imports across the codebase use `import type` syntax\n- [ ] No runtime behavior changes (types are erased at compile time)\n- [ ] All existing tests pass (`npm test`)\n- [ ] No TypeScript errors (`npm run typecheck`)\n- [ ] Linting passes (`npm run lint`)","status":"closed","priority":4,"issue_type":"task","owner":"roux.tom@gmail.com","created_at":"2026-01-23T21:45:32.214202+01:00","created_by":"spartDev","updated_at":"2026-01-24T11:53:53.715166+01:00","closed_at":"2026-01-24T11:53:53.715166+01:00","close_reason":"PR merged"}
